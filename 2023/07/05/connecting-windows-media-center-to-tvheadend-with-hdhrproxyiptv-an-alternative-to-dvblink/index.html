<!DOCTYPE html><html><head><meta charset="utf-8"><title>Connecting Windows Media Center to Tvheadend with HDHRProxyIPTV: an alternative to DVBLink | Kévin Chalet&#39;s blog</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="description" content="This blog post was updated to use a different method for injecting the channels into the WMC database. The attached tool has been updated accordingly.   After more than 13 years of continuous use, I&#39;m"><meta property="og:type" content="article"><meta property="og:title" content="Connecting Windows Media Center to Tvheadend with HDHRProxyIPTV: an alternative to DVBLink"><meta property="og:url" content="https://kevinchalet.com/2023/07/05/connecting-windows-media-center-to-tvheadend-with-hdhrproxyiptv-an-alternative-to-dvblink/index.html"><meta property="og:site_name" content="Kévin Chalet&#39;s blog"><meta property="og:description" content="This blog post was updated to use a different method for injecting the channels into the WMC database. The attached tool has been updated accordingly.   After more than 13 years of continuous use, I&#39;m"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://kevinchalet.com/2023/07/05/connecting-windows-media-center-to-tvheadend-with-hdhrproxyiptv-an-alternative-to-dvblink/tvheadend-channels-list.png"><meta property="og:image" content="https://kevinchalet.com/2023/07/05/connecting-windows-media-center-to-tvheadend-with-hdhrproxyiptv-an-alternative-to-dvblink/hdhomerun-setup.png"><meta property="og:image" content="https://kevinchalet.com/2023/07/05/connecting-windows-media-center-to-tvheadend-with-hdhrproxyiptv-an-alternative-to-dvblink/epg123.png"><meta property="og:image" content="https://kevinchalet.com/2023/07/05/connecting-windows-media-center-to-tvheadend-with-hdhrproxyiptv-an-alternative-to-dvblink/windows-media-center-tv-setup.png"><meta property="article:published_time" content="2023-07-05T18:00:00.000Z"><meta property="article:modified_time" content="2023-09-20T10:51:59.000Z"><meta property="article:author" content="Kévin Chalet"><meta property="article:tag" content="windows media center"><meta property="article:tag" content="dvblink"><meta property="article:tag" content="hdhomerun"><meta property="article:tag" content="hdhrproxytv"><meta property="article:tag" content="tv"><meta property="article:tag" content="tvheadend"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://kevinchalet.com/2023/07/05/connecting-windows-media-center-to-tvheadend-with-hdhrproxyiptv-an-alternative-to-dvblink/tvheadend-channels-list.png"><meta name="twitter:creator" content="@kevin_chalet"><link rel="icon" href="https://kevinchalet.com/assets/photo.png"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css"><script type="text/javascript">!function(e,a,t,n,g,c,o){e.GoogleAnalyticsObject=g,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),o=a.getElementsByTagName(t)[0],c.async=1,c.src="//www.google-analytics.com/analytics.js",o.parentNode.insertBefore(c,o)}(window,document,"script",0,"ga"),ga("create","UA-79360312-1","auto"),ga("send","pageview")</script><meta name="generator" content="Hexo 6.2.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head><body><div id="container"><header id="header"><div id="header-main" class="header-inner"><div class="outer"><a href="/" id="logo"><span class="site-title">Kévin Chalet&#39;s blog</span></a><nav id="main-nav"><a class="main-nav-link" href="/.">Home</a> <a class="main-nav-link" href="/archives/">Archives</a></nav><nav id="sub-nav"><div class="profile" id="profile-nav"><a id="profile-anchor" href="javascript:;"><img class="avatar" src="https://kevinchalet.com/assets/photo.png"><i class="fa fa-caret-down"></i></a></div></nav><div id="search-form-wrap"><form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit"></button><input type="hidden" name="sitesearch" value="https://kevinchalet.com"></form></div></div></div></header><div class="outer"><aside id="profile"><div class="inner profile-inner"><div class="base-info profile-block"><img id="avatar" src="https://kevinchalet.com/assets/photo.png"><h2 id="name">Kévin Chalet</h2><h3 id="title">.NET-holic and OpenID-addict MVP in the wild.</h3><span id="location"><i class="fa fa-map-marker"></i>France</span> <a id="follow" target="_blank" rel="noopener" href="https://twitter.com/intent/user?screen_name=kevin_chalet"><i class="fa fa-twitter fa-lg"></i> Follow me on Twitter</a></div><div class="article-info profile-block"><div class="article-info-block">46 <span>posts</span></div><div class="article-info-block">37 <span>tags</span></div></div><div class="contact-info profile-block"><table class="contact-list"><tr><td><a href="mailto:contact@kevinchalet.com" title="Email"><i class="fa fa-envelope"></i></a></td><td><a target="_blank" rel="noopener" href="https://www.linkedin.com/in/kevinchalet/" title="LinkedIn"><i class="fa fa-linkedin"></i></a></td><td><a target="_blank" rel="noopener" href="https://github.com/kevinchalet" title="GitHub"><i class="fa fa-github"></i></a></td><td><a target="_blank" rel="noopener" href="https://twitter.com/kevin_chalet" title="Twitter"><i class="fa fa-twitter"></i></a></td><td><a target="_blank" rel="noopener" href="https://stackoverflow.com/users/542757/k%c3%a9vin-chalet" title="StackOverflow"><i class="fa fa-stack-overflow"></i></a></td><td><a target="_blank" rel="noopener" href="https://mvp.microsoft.com/fr-fr/PublicProfile/5001682" title="Microsoft MVP"><i class="fa fa-windows"></i></a></td><td><a href="/atom.xml" title="RSS"><i class="fa fa-rss"></i></a></td></tr></table></div></div></aside><section id="main"><article id="post-connecting-windows-media-center-to-tvheadend-with-hdhrproxyiptv-an-alternative-to-dvblink" class="article article-type-post" itemscope itemprop="blogPost"><div class="article-inner"><header class="article-header"><h1 class="article-title" itemprop="name">Connecting Windows Media Center to Tvheadend with HDHRProxyIPTV: an alternative to DVBLink</h1><div class="article-meta"><div class="article-date"><i class="fa fa-calendar"></i> <a href="/2023/07/05/connecting-windows-media-center-to-tvheadend-with-hdhrproxyiptv-an-alternative-to-dvblink/"><time datetime="2023-07-05T18:00:00.000Z" itemprop="datePublished">2023-07-05</time></a></div><div class="article-category"><i class="fa fa-folder"></i> <a class="article-category-link" href="/categories/development/">Development</a></div></div></header><div class="article-entry" itemprop="articleBody"><div class="note tip"><p>This blog post was updated to use a different method for injecting the channels into the WMC database. The attached tool has been updated accordingly.</p></div><p>After more than 13 years of continuous use, I'm saying goodbye to my traditional Windows Media Center TV setup 😊</p><p>Like many (if not most) users, I've always been using Windows Media Center with terrestrial tuners physically attached to my HTPCs:</p><ul><li>A USB dual-tuner Sony PlayTV when I started playing with WMC back in 2008 (an excellent device that's still working just fine).</li><li>A PCI dual-tuner Hauppauge WinTV-NOVA-TD-500.</li><li>A PCIe dual-tuner AVerMedia AVerTV Duo Hybrid (the hardware is good but the driver is terrible and has been responsible for a lot of blue screens...)</li><li>A PCIe quad-tuner Hauppauge WinTV-quadHD – great hardware and great driver! – when I eventually got tired of the crashes caused by the AVerTV Duo Hybrid.</li></ul><p>While this setup certainly lacked the flexibility of more elaborate options based on network tuners (like the popular <a target="_blank" rel="noopener" href="https://www.silicondust.com/">HDHomeRun</a>) or virtualized tuners such as the now defunct <a target="_blank" rel="noopener" href="http://web.archive.org/web/20170114230710/https://dvblogic.com/en/dvblink/">DVBLink</a>, it was actually trivial to set up and <em>exceptionally stable</em>, specially since replacing the old TV tuners by newer Hauppauge WinTV-quadHD cards (these things are not only ultra-stable but they also offer low-latency channel switching and have a fairly good reception).</p><p>So, why changing something that has been working so well? It all started with a message posted by a user of the My Digital Life forum – <a target="_blank" rel="noopener" href="https://forums.mydigitallife.net/members/acer-5100.1190204/">acer-5100</a> – about <a target="_blank" rel="noopener" href="https://forums.mydigitallife.net/threads/discussion-patch-wmc-to-run-on-windows-10-final-possible-alternatives.61061/page-528#post-1783979">using Windows Media Center with H.265/HEVC channels</a>.</p><p>As you probably already know, due to internal Windows Media Center/DirectShow limitations, only MPEG1, MPEG2 and H.264 channels are supported and it's not possible to watch or record H.265/HEVC channels, even if you install the appropriate DirectShow codecs. Since WMC was <a target="_blank" rel="noopener" href="http://localhost:4000/2018/10/07/highway-to-dll-hell/">abandoned by Microsoft many years ago</a>, it's extremely unlikely we'll ever see an update to make it compatible with HEVC channels.</p><p>To work around this limitation, acer-5100 opted for <a target="_blank" rel="noopener" href="https://forums.mydigitallife.net/threads/discussion-patch-wmc-to-run-on-windows-10-final-possible-alternatives.61061/page-529#post-1784349">a simple but clever setup</a> that consists in combining DVBLink (and its IPTV source plugin) with <a target="_blank" rel="noopener" href="https://tvheadend.org/">Tvheadend</a>: by simply configuring DVBLink to use transcoded streams provided by Tvheadend rather than the original HEVC sources, Windows Media Center always gets a good old MPEG2 or H.264 video stream it can decode without any issue. Simple and clever.</p><span id="more"></span><p>When the French government announced a few years ago that terrestrial television in France would eventually move to DVB-T2 and adopt HEVC and AC4 as the new video and audio codecs, I imagined a similar – but slightly different – setup combining Tvheadend, the HDHomeRun BDA integration and an HDHomeRun emulator usable by Windows Media Center. Sadly, due to the COVID19 pandemic, the DVB-T2/HEVC/AC4 transition was postponed multiple times and the HEVC demo multiplexes never showed up in my region.</p><p>A <a target="_blank" rel="noopener" href="https://lafibre.info/tv-numerique-hd-3d/tnt-uhd-en-france/12/">first DVB-T2 multiplex will be progressively deployed in most regions of France later this year</a>, but acer-5100's results were so promising that I decided not to wait for the DVB-T2 mux to be available to start testing these two options:</p><ul><li><p>I initially decided to give acer-5100's DVBLink-based approach a try: thanks to acer-5100, I was able to download the hard-to-find DVBLink 4.1 installer and managed to make the whole thing work after a few attempts. Unfortunately, the result wasn't great: it worked, but the channel switching delay was higher than my traditional setup and I was getting frequent <code>PlayReady update incomplete</code> errors that required switching to a different channel before switching back to the channel I wanted to watch (definitely not a great user experience!). After chatting with acer-5100, he confirmed he was also seeing similar errors from time to time. I tried a few other DVBLink versions, but each had its own issues (which surprised me quite a bit as DVBLink has always been a popular option amongst the Windows Media Center enthusiasts).</p></li><li><p>I then decided to give my variant a try: installing the HDHomeRun BDA driver was trivial as even the latest version worked absolutely fine. Once installed, all I needed was an HDHomeRun emulator to make the HDHomeRun BDA driver think it was communicating with a real HDHomeRun device: I initially opted for <a target="_blank" rel="noopener" href="https://github.com/jfarseneau/antennas">Antennas</a>, but it wasn't recognized by the HDHomeRun setup utility, most likely because it doesn't emulate all the APIs it needs. I quickly gave up and tried the fantastic <a target="_blank" rel="noopener" href="https://github.com/dsaupf/HDHRProxyIPTV">HDHRProxyIPTV</a> instead: while it's no longer actively developed and not super easy to configure, it works just fine and is extremely stable.</p></li></ul><p>The <code>Tvheadend + HDHomeRun BDA + HDHRProxyIPTV</code> combo proved to be so good that I decided to experiment it on two machines – a Raspberry PI 3 with a Sony Play TV attached and Tvheadend installed and a Windows 10 machine with Windows Media Center set up - during a whole month.</p><p>After a month, the conclusion was clear: not only the channel switching times were comparable to my traditional setup (despite the additional IP latency caused by the use of Ethernet/PLC adapters), but it was also as stable as a physically attached tuner: <strong>the flexibility of DVBLink without any of the downsides</strong> 😎</p><p>I've since replaced the Raspberry PI by a more traditional x64 machine running Ubuntu Server with two Hauppauge WinTV-quadHD PCIe cards attached (as it will be much better at transcoding than a limited ARM SBC), but I haven't changed anything to the client part.</p><p>Given that I'm extremely happy with the result, I decided to write this post for those who would be interested in an alternative to DVBLink. While there's nothing terribly complicated, the whole process is of course much more elaborate than simply configuring a physically-attached TV tuner: if you're not willing to get your hands dirty, I would probably not recommend this option 😁</p><p>Still reading? Nice! Here's what we'll need for a complete setup:</p><ul><li><p><strong>Tvheadend</strong>, that will be used to manage the DVB-T(2) tuners, expose the DVB MPEG Transport Streams via its built-in HTTP server and – if needed – transcode the video streams.</p></li><li><p><strong>The HDHomeRun BDA driver</strong> that is part of the <code>HDHomeRun Software for Windows</code> package.</p></li><li><p><strong>HDHRProxyIPTV</strong>, for which you can find an already compiled x86 Windows executable in the GitHub repository of the project: <a target="_blank" rel="noopener" href="https://github.com/dsaupf/HDHRProxyIPTV/tree/master/Release">https://github.com/dsaupf/HDHRProxyIPTV/tree/master/Release</a>.</p></li><li><p><strong>A way to inject the Tvheadend channels in Windows Media Center's database</strong>.</p></li></ul><h2 id="Install-and-configure-Tvheadend"><a href="#Install-and-configure-Tvheadend" class="headerlink" title="Install and configure Tvheadend"></a>Install and configure Tvheadend</h2><p>While alternatives exist – like the excellent <code>minisatip</code> – <strong>Tvheadend</strong> is by far the most flexible and user-friendly headend software.</p><p>Of course, nothing in this world is perfect and there's a downside: Tvheadend is not available on Windows, so you'll need a Linux machine (Tvheadend itself will work fine on Windows Subsystem for Linux or in more traditional virtual machines, but if you want to use a PCIe or USB tuner to receive terrestrial or satellite TV, it's surely going to be a painful process and the result might not be as stable as you'd expect).</p><p>Installing Tvheadend is quite easy, but the configuration part will differ depending on how you receive TV (e.g IPTV, DVB-T, DVB-C, DVB-S or a mix of multiple sources). If you're not familiar with Tvheadend, don't miss the tutorial written by the Pi Mylife Up guys: <a target="_blank" rel="noopener" href="https://pimylifeup.com/raspberry-pi-tvheadend/">https://pimylifeup.com/raspberry-pi-tvheadend/</a>.</p><p>Once everything is correctly configured, you should see the list of channels under the Configuration &gt; Channel/EPG &gt; Channels tab:</p><img src="/2023/07/05/connecting-windows-media-center-to-tvheadend-with-hdhrproxyiptv-an-alternative-to-dvblink/tvheadend-channels-list.png"><h2 id="Install-the-HDHomeRun-BDA-driver"><a href="#Install-the-HDHomeRun-BDA-driver" class="headerlink" title="Install the HDHomeRun BDA driver"></a>Install the HDHomeRun BDA driver</h2><p>For that, head to <a target="_blank" rel="noopener" href="https://www.silicondust.com/support/downloads/">https://www.silicondust.com/support/downloads/</a>, download the latest <code>HDHomeRun Software for Windows</code> package and simply follow the installation wizard.</p><h2 id="Download-and-configure-HDHRProxyIPTV"><a href="#Download-and-configure-HDHRProxyIPTV" class="headerlink" title="Download and configure HDHRProxyIPTV"></a>Download and configure HDHRProxyIPTV</h2><p>An already compiled x86 Windows executable can be found in the GitHub repository of the project alongside the default configuration files: <a target="_blank" rel="noopener" href="https://github.com/dsaupf/HDHRProxyIPTV/tree/master/Release">https://github.com/dsaupf/HDHRProxyIPTV/tree/master/Release</a>. Download the 3 files and store them in the same folder but don't start the executable yet.</p><div class="note tip"><p>For those who prefer running HDHRProxyIPTV as a Windows service (which is ideal for a headless WMC recording server), I created a simple installer containing the official .exe from GitHub and a local copy of <a target="_blank" rel="noopener" href="https://github.com/winsw/winsw">WinSW 3</a> that allows using <code>HDHRProxyIPTV.exe</code> as a service (the configuration files are stored alongside these executables in <code>C:\Program Files (x86)\HDHRProxyIPTV</code>, which requires admin rights to edit them).</p><p>Of course, since it runs as a service, there's no GUI visible, which can make the debugging process more complicated: in this case, I suggest starting with the "regular" version of HDHRProxyIPTV and switching to the service approach once you have a working <code>HDHRProxyIPTV.ini</code>/<code>HDHRProxyIPTV_MappingList.ini</code>.</p><p>You can find the <code>.msi</code> installer here: <a href="/2023/07/05/connecting-windows-media-center-to-tvheadend-with-hdhrproxyiptv-an-alternative-to-dvblink/HDHRProxyIPTV.msi" title="HDHRProxyIPTV.msi">HDHRProxyIPTV.msi</a>.</p></div><p>Configuring HDHRProxyIPTV is the most complicated part, as there are two distinct files that need to be updated:</p><ul><li><p><code>HDHRProxyIPTV.ini</code>: it contains the <code>HDHRProxyIPTV</code> configuration and all the settings of the emulated HDHomeRun device. Most of the lines should be left as-is, but three options deserve a special attention:</p><ul><li><p>The device ID: a default device identifier is already present in the file so you don't have to change it. That said, if you plan on having multiple instances of <code>HDHRProxyIPTV</code> – for instance if you opt for installing it on each WMC machine as I did (instead of on a centralized server) – you'll need to use different device identifiers for each of your <code>HDHRProxyIPTV</code> instances to avoid collisions.</p></li><li><p>The number of tuners: by default, only 2 tuners will be created, but you can select up to 9 tuners (and not 8, as indicated in the file). It's worth noting that the number of virtual tuners exposed to WMC doesn't have to match the number of physical tuners attached to the Tvheadend machine: you can of course select a lower number, but also a higher value if you want to be able to record multiple channels of the same DVB multiplex (in this case, Tvheadend is smart enough to reuse the same physical tuner when the requested channels share the same DVB frequency).</p></li><li><p>The auto-start option: it is disabled by default but can be set to <code>1</code> if you want the emulated device to start automatically when the <code>HDHRProxyIPTV</code> executable is launched, which is very convenient if you add <code>HDHRProxyIPTV</code> to the list of programs that are started when opening your WIndows session.</p></li></ul></li><li><p><code>HDHRProxyIPTV_MappingList.ini</code>: it contains all the channels that will be accessible by the emulated HDHomeRun device. Each channel has a channel ID that you can set to any value you want and a virtual DVB-T frequency range. Here's an example of a mapping file containing 2 channels:</p></li></ul><figure class="highlight ini"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[MAPPING_LIST]</span></span><br><span class="line"><span class="attr">NUM_CHANNELS</span>=<span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="section">[CH1]</span></span><br><span class="line"><span class="attr">Channel</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">LowFreq</span>=<span class="number">100001000</span></span><br><span class="line"><span class="attr">HighFreq</span>=<span class="number">100001000</span></span><br><span class="line"><span class="attr">Protocol</span>=HTTP</span><br><span class="line"><span class="attr">URLGet</span>=http://[IP address of your Tvheadend server]:<span class="number">9981</span>/stream/channelnumber/<span class="number">1</span></span><br><span class="line"><span class="attr">InternalPIDFiltering</span>=N</span><br><span class="line"><span class="attr">ExternalPIDFiltering</span>=N</span><br><span class="line"><span class="attr">Signal_Strength</span>=<span class="number">95</span></span><br><span class="line"><span class="attr">Signal_Quality</span>=<span class="number">90</span></span><br><span class="line"><span class="attr">Symbol_Quality</span>=<span class="number">100</span></span><br><span class="line"><span class="attr">Network_Rate</span>=<span class="number">20000000</span></span><br><span class="line"></span><br><span class="line"><span class="section">[CH2]</span></span><br><span class="line"><span class="attr">Channel</span>=<span class="number">2</span></span><br><span class="line"><span class="attr">LowFreq</span>=<span class="number">100002000</span></span><br><span class="line"><span class="attr">HighFreq</span>=<span class="number">100002000</span></span><br><span class="line"><span class="attr">Protocol</span>=HTTP</span><br><span class="line"><span class="attr">URLGet</span>=http://[IP address of your Tvheadend server]:<span class="number">9981</span>/stream/channelnumber/<span class="number">2</span></span><br><span class="line"><span class="attr">InternalPIDFiltering</span>=N</span><br><span class="line"><span class="attr">ExternalPIDFiltering</span>=N</span><br><span class="line"><span class="attr">Signal_Strength</span>=<span class="number">95</span></span><br><span class="line"><span class="attr">Signal_Quality</span>=<span class="number">90</span></span><br><span class="line"><span class="attr">Symbol_Quality</span>=<span class="number">100</span></span><br><span class="line"><span class="attr">Network_Rate</span>=<span class="number">20000000</span></span><br></pre></td></tr></tbody></table></figure><p>While the <code>HDHRProxyIPTV_MappingList.ini</code> file was designed to be edited by hand, it's a terribly boring and error-prone process as soon as you have more than a dozen channels, so we'll see how to automate its creation – and the registration of the corresponding channels in the WMC database – in a few minutes.</p><p>If you prefer creating this file manually, here's my recommendations:</p><ul><li><p>To keep things simple, use the Tvheadend channel number for the <code>Channel</code> line.</p></li><li><p>While you're free to use any value you want for <code>LowFreq</code> and <code>HighFreq</code> – including real DVB-T frequencies – it's a good idea to use a fake frequency that doesn't match the real frequency of the DVB multiplex the channel belongs to. I personally opted for a simple scheme: the first channel always starts at <code>100001 KHz</code> and we add <code>1 KHz</code> for each new channel. In any case, the actual value doesn't matter much, as we'll directly inject the channel details into WMC's database instead of performing an actual frequency scan.</p></li><li><p>Once configured, launch <code>HDHRProxyIPTV.exe</code> and press <code>Start</code> in the bottom left corner.</p></li></ul><h2 id="Configure-the-HDHomeRun-device"><a href="#Configure-the-HDHomeRun-device" class="headerlink" title="Configure the HDHomeRun device"></a>Configure the HDHomeRun device</h2><p>For that, start the <code>HDHomeRun Setup</code> utility (make sure you start <code>HDHomeRun Setup</code> and not <code>HDHomeRun Config GUI</code>!).</p><p>Once started, <code>HDHomeRun Setup</code> should initiate a firmware update: of course, since the device is emulated, no actual update will happen, but <strong>don't cancel the process</strong>: just wait a few moments and the message will eventually disappear.</p><p>When it's done, ensure the source type of the tuners you want to enable is set to <code>Digital Antenna</code> and click <code>Apply</code>:</p><img src="/2023/07/05/connecting-windows-media-center-to-tvheadend-with-hdhrproxyiptv-an-alternative-to-dvblink/hdhomerun-setup.png"><div class="note tip"><p>Depending on the device ID you chose, the tuners might either appear as individual "sub-devices" or as a single, multi-tuner device: in both cases, things will work exactly the same way and the rest of the process will be identical.</p></div><h2 id="Configure-the-HDHomeRun-tuners-in-Windows-Media-Center"><a href="#Configure-the-HDHomeRun-tuners-in-Windows-Media-Center" class="headerlink" title="Configure the HDHomeRun tuners in Windows Media Center"></a>Configure the HDHomeRun tuners in Windows Media Center</h2><div class="note warn"><p>If you configured your emulated HDHomeRun device to expose more than 4 tuners, you'll need to tweak WMC to be able to configure more than 4 tuners of the same type. This can be done using <a target="_blank" rel="noopener" href="https://www.thegreenbutton.tv/wiki/TunerSalad"><strong>TunerSalad</strong></a> or via <strong>epg123</strong> (my recommended option).</p><p>If you opted for <strong>epg123</strong>, launch <code>epg123Client.exe</code>, click <code>Tweak WMC</code> and press <code>Increase</code> next to <code>Increase tuner limits to 32 per tuner type</code>:</p><img src="/2023/07/05/connecting-windows-media-center-to-tvheadend-with-hdhrproxyiptv-an-alternative-to-dvblink/epg123.png"></div><p>To configure the HDHomeRun tuners, go to <code>TV Setup</code> and follow the wizard: when WMC starts examining the TV signals, click <code>Cancel</code> and select <code>Let me configure my TV signal manually</code>. Then, select <code>Antenna</code>, click <code>Next</code> and ensure all the virtual TV tuners you want to enable are selected:</p><img src="/2023/07/05/connecting-windows-media-center-to-tvheadend-with-hdhrproxyiptv-an-alternative-to-dvblink/windows-media-center-tv-setup.png"><p>Then, click <code>Next</code> and when WMC starts searching for new channels, click <code>Stop Scan</code> and finish the setup process.</p><h2 id="Inject-the-Tvheadend-channels"><a href="#Inject-the-Tvheadend-channels" class="headerlink" title="Inject the Tvheadend channels"></a>Inject the Tvheadend channels</h2><p>Windows Media Center doesn't offer a way to create arbitrary channels via its graphical user interface. Luckily, it's possible to do it programmatically using public APIs that are part of Windows Media Center.</p><p>For that, I created a simple .NET Framework 4.8 application that does 4 things:</p><ul><li>It retrieves all the available channels from the Tvheadend server.</li><li><strong>It removes all the existing channels present in the Windows Media Center database and creates a WMC channel for each Tvheadend channel</strong>.</li><li>It creates a Tvheadend MPEG pass-through stream profile per channel (profiles previously created by the tool are automatically deleted before recreating them).</li><li>It creates a <code>HDHRProxyIPTV_MappingList.ini</code> file containing all the channels retrieved from the Tvheadend server.</li></ul><div class="note info"><p>By default, when Tvheadend extracts the elementary streams associated to a single channel – called Single Program Transport Stream (or <em>SPTS</em>) – from the Multiple Program Transport Stream (or <em>MPTS</em>) returned by the physical tuner, it doesn't preserve the MPEG network ID/transport stream ID/service ID of the original stream and arbitrarily sets all these values to <code>1</code>.</p><p>Unfortunately, when multiple channels share the same exact DVB information, Windows Media Center ends up merging them automatically at some point (a process typically performed by the <code>mcGlidHost</code> executable). While it is possible to disable this mechanism, using the same DVB information has other side-effects like forcing a bogus channel change when recording a program on another channel while already watching live TV.</p><p>To prevent that, the tool automatically asks Tvheadend to create stream profiles that enforce a unique service ID per channel and uses this identifier when injecting the channel into the WMC database to produce a unique <code>DvbTuningInfo</code> instance that won't be shared by multiple channels.</p></div><figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Project</span> <span class="attr">Sdk</span>=<span class="string">"Microsoft.NET.Sdk"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">PropertyGroup</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">OutputType</span>&gt;</span>Exe<span class="tag">&lt;/<span class="name">OutputType</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">TargetFramework</span>&gt;</span>net48<span class="tag">&lt;/<span class="name">TargetFramework</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">LangVersion</span>&gt;</span>11<span class="tag">&lt;/<span class="name">LangVersion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Nullable</span>&gt;</span>enable<span class="tag">&lt;/<span class="name">Nullable</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">RuntimeIdentifier</span>&gt;</span>win7-x64<span class="tag">&lt;/<span class="name">RuntimeIdentifier</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">PropertyGroup</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">PropertyGroup</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">AssemblySearchPaths</span>&gt;</span>$(AssemblySearchPaths);$(SystemRoot)\ehome<span class="tag">&lt;/<span class="name">AssemblySearchPaths</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">PropertyGroup</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">ItemGroup</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">PackageReference</span> <span class="attr">Include</span>=<span class="string">"Spectre.Console"</span> <span class="attr">Version</span>=<span class="string">"0.47.1-preview.0.8"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">PackageReference</span> <span class="attr">Include</span>=<span class="string">"System.Net.Http.Json"</span> <span class="attr">Version</span>=<span class="string">"7.0.1"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">ItemGroup</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">ItemGroup</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Reference</span> <span class="attr">Include</span>=<span class="string">"BDATunePIA"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Reference</span> <span class="attr">Include</span>=<span class="string">"mcepg"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Reference</span> <span class="attr">Include</span>=<span class="string">"mcstore"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">ItemGroup</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">Project</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><figure class="highlight csharp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> System.Globalization;</span><br><span class="line"><span class="keyword">using</span> System.IO;</span><br><span class="line"><span class="keyword">using</span> System.Linq;</span><br><span class="line"><span class="keyword">using</span> System.Net.Http;</span><br><span class="line"><span class="keyword">using</span> System.Net.Http.Headers;</span><br><span class="line"><span class="keyword">using</span> System.Net.Http.Json;</span><br><span class="line"><span class="keyword">using</span> System.Security.Cryptography;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"><span class="keyword">using</span> System.Text.Json;</span><br><span class="line"><span class="keyword">using</span> System.Text.Json.Nodes;</span><br><span class="line"><span class="keyword">using</span> System.Threading;</span><br><span class="line"><span class="keyword">using</span> System.Threading.Tasks;</span><br><span class="line"><span class="keyword">using</span> Microsoft.MediaCenter.Guide;</span><br><span class="line"><span class="keyword">using</span> Microsoft.MediaCenter.Store;</span><br><span class="line"><span class="keyword">using</span> Spectre.Console;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">var</span> client = <span class="keyword">new</span> HttpClient();</span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span>? administratorUsername = <span class="literal">null</span>, administratorPassword = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> server = <span class="keyword">new</span> Uri(<span class="keyword">await</span> <span class="keyword">new</span> TextPrompt&lt;<span class="built_in">string</span>&gt;(<span class="string">"Enter the URL of the Tvheadend server (port included and without the user credentials):"</span>)</span><br><span class="line">    .Validate(uri =&gt; Uri.TryCreate(uri, UriKind.Absolute, <span class="keyword">out</span> Uri <span class="keyword">value</span>) &amp;&amp; <span class="keyword">value</span>.IsWellFormedOriginalString())</span><br><span class="line">    .ShowAsync(AnsiConsole.Console, CancellationToken.None), UriKind.Absolute);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> streamingUsername = <span class="keyword">await</span> <span class="keyword">new</span> TextPrompt&lt;<span class="built_in">string</span>&gt;(<span class="string">"Enter the name of a user account allowed to access the Tvheadend streams (or type ENTER if anonymous access is enabled):"</span>)</span><br><span class="line">    .AllowEmpty()</span><br><span class="line">    .ShowAsync(AnsiConsole.Console, CancellationToken.None);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> streamingPassword = <span class="keyword">await</span> <span class="keyword">new</span> TextPrompt&lt;<span class="built_in">string</span>&gt;(<span class="string">"Enter the password of a user account allowed to access the Tvheadend streams (or type ENTER if anonymous access is enabled):"</span>)</span><br><span class="line">    .AllowEmpty()</span><br><span class="line">    .ShowAsync(AnsiConsole.Console, CancellationToken.None);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> createChannels = <span class="keyword">await</span> <span class="keyword">new</span> ConfirmationPrompt(<span class="string">"Do you want to import the Tvheadend channels into the WMC database? (IMPORTANT: this removes all the existing WMC channels):"</span>)</span><br><span class="line">    .ShowAsync(AnsiConsole.Console, CancellationToken.None);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> createProfiles = <span class="keyword">await</span> <span class="keyword">new</span> ConfirmationPrompt(<span class="string">"Do you want to create the Tvheadend stream profiles (note: the existing profiles created by this tool are automatically removed):"</span>)</span><br><span class="line">    .ShowAsync(AnsiConsole.Console, CancellationToken.None);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (createProfiles)</span><br><span class="line">{</span><br><span class="line">    administratorUsername = <span class="keyword">await</span> <span class="keyword">new</span> TextPrompt&lt;<span class="built_in">string</span>&gt;(<span class="string">"Enter the name of a Tvheadend administrator account:"</span>)</span><br><span class="line">        .ShowAsync(AnsiConsole.Console, CancellationToken.None);</span><br><span class="line"></span><br><span class="line">    administratorPassword = <span class="keyword">await</span> <span class="keyword">new</span> TextPrompt&lt;<span class="built_in">string</span>&gt;(<span class="string">"Enter the password of a Tvheadend administrator account:"</span>)</span><br><span class="line">        .ShowAsync(AnsiConsole.Console, CancellationToken.None);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> channels = <span class="keyword">await</span> GetTvheadendChannelsAsync(client, server, streamingUsername, streamingPassword);</span><br><span class="line"><span class="keyword">if</span> (channels.Count <span class="keyword">is</span> <span class="number">0</span>)</span><br><span class="line">{</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> InvalidOperationException(<span class="string">"No channel can be found in the Tvheadend lineup. Make sure channels were correctly added in Tvheadend."</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (createProfiles)</span><br><span class="line">{</span><br><span class="line">    <span class="keyword">await</span> DeleteTvheadendStreamProfiles(client, server, administratorUsername, administratorPassword);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">var</span> algorithm = SHA256.Create();</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">var</span> store = ObjectStore.Open(providerName: <span class="string">"Anonymous!User"</span>, password: Convert.ToBase64String(</span><br><span class="line">    algorithm.ComputeHash(Encoding.Unicode.GetBytes(ObjectStore.GetClientId(createIfMissing: <span class="literal">true</span>)))));</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">var</span> mergedChannels = <span class="keyword">new</span> MergedChannels(store);</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">var</span> mergedLineups = <span class="keyword">new</span> MergedLineups(store);</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">var</span> services = <span class="keyword">new</span> Services(store);</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">var</span> lineups = <span class="keyword">new</span> Lineups(store);</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">var</span> devices = <span class="keyword">new</span> Devices(store);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> tuners = devices</span><br><span class="line">    .Where(device =&gt; device.Name.IndexOf(<span class="string">"HDHomeRun"</span>, StringComparison.OrdinalIgnoreCase) != <span class="number">-1</span>)</span><br><span class="line">    .Where(device =&gt; device.Name.IndexOf(<span class="string">"Deleted"</span>, StringComparison.OrdinalIgnoreCase) == <span class="number">-1</span>)</span><br><span class="line">    .Where(device =&gt; device.IsDvbTuningInfoSupported)</span><br><span class="line">    .ToList();</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (tuners.Count <span class="keyword">is</span> <span class="number">0</span>)</span><br><span class="line">{</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> InvalidOperationException(<span class="string">"No HDHomeRun tuner can be found. Make sure at least one tuner is created using the setup utility."</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> mergedLineup = mergedLineups.WithUId(<span class="string">"!MCLineup!MainLineup"</span>) ??</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> InvalidOperationException(<span class="string">"The main MCE lineup cannot be resolved. Make sure TV was correctly set up in WMC."</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> lineup = tuners[<span class="number">0</span>].ScannedLineup;</span><br><span class="line"><span class="keyword">if</span> (lineup <span class="keyword">is</span> <span class="literal">null</span>)</span><br><span class="line">{</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> InvalidOperationException(<span class="string">"The scanned lineup associated with the virtual tuner cannot be resolved."</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (createChannels)</span><br><span class="line">{</span><br><span class="line">    <span class="keyword">foreach</span> (Device tuner <span class="keyword">in</span> tuners)</span><br><span class="line">    {</span><br><span class="line">        tuner.ScanDeviceConfig.ParasiticScanOptions = InbandLoaderOptions.None;</span><br><span class="line">        tuner.ScanDeviceConfig.PeriodicScanOptions = InbandLoaderOptions.None;</span><br><span class="line">        tuner.ScanDeviceConfig.Update();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">foreach</span> (Channel channel <span class="keyword">in</span> lineup.GetChannels())</span><br><span class="line">    {</span><br><span class="line">        lineup.RemoveChannel(channel);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">foreach</span> (MergedChannel channel <span class="keyword">in</span> mergedLineup.GetChannels())</span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">string</span>.Equals(channel.PrimaryChannel?.Lineup?.Name, lineup.Name, StringComparison.OrdinalIgnoreCase) &amp;&amp;</span><br><span class="line">            channel.SecondaryChannels.Any(channel =&gt; <span class="built_in">string</span>.Equals(channel.Lineup?.Name, lineup.Name, StringComparison.OrdinalIgnoreCase)))</span><br><span class="line">        {</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        mergedLineup.RemoveChannel(channel);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> builder = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">builder.AppendLine(<span class="string">"[MAPPING_LIST]"</span>);</span><br><span class="line">builder.AppendLine(<span class="string">$"NUM_CHANNELS=<span class="subst">{channels.Count}</span>"</span>);</span><br><span class="line">builder.AppendLine();</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> index = <span class="number">0</span>; index &lt; channels.Count; index++)</span><br><span class="line">{</span><br><span class="line">    <span class="keyword">var</span> channel = channels[index];</span><br><span class="line">    <span class="keyword">var</span> frequency = <span class="number">100</span>_000 + channel.ChannelNumber;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (createChannels)</span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">var</span> service = services.FirstOrDefault(service =&gt;</span><br><span class="line">            <span class="built_in">string</span>.Equals(service.CallSign, channel.ChannelName, StringComparison.OrdinalIgnoreCase) &amp;&amp;</span><br><span class="line">            <span class="built_in">string</span>.Equals(service.Name, channel.ChannelName, StringComparison.OrdinalIgnoreCase));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (service <span class="keyword">is</span> <span class="literal">null</span>)</span><br><span class="line">        {</span><br><span class="line">            service = <span class="keyword">new</span> Service</span><br><span class="line">            {</span><br><span class="line">                CallSign = channel.ChannelName,</span><br><span class="line">                Name = channel.ChannelName</span><br><span class="line">            };</span><br><span class="line"></span><br><span class="line">            services.Add(service);</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> lineupChannel = <span class="keyword">new</span> Channel</span><br><span class="line">        {</span><br><span class="line">            ChannelType = ChannelType.Scanned,</span><br><span class="line">            Number = channel.ChannelNumber,</span><br><span class="line">            Service = service</span><br><span class="line">        };</span><br><span class="line"></span><br><span class="line">        lineup.AddChannel(lineupChannel);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">foreach</span> (Device tuner <span class="keyword">in</span> tuners)</span><br><span class="line">        {</span><br><span class="line">            lineupChannel.TuningInfos.Add(<span class="keyword">new</span> DvbTuningInfo(tuner, onid: <span class="number">1</span>, tsid: <span class="number">1</span>, sid: channel.ChannelNumber, nid: <span class="number">1</span>, frequency, channel.ChannelNumber));</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        lineupChannel.Update();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> mergedChannel = <span class="keyword">new</span> MergedChannel(mergedLineup, lineupChannel, <span class="literal">null</span>, <span class="literal">null</span>);</span><br><span class="line">        mergedChannel.Update();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (createProfiles)</span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">await</span> CreateTvheadendStreamProfile(client, server, channel.ChannelNumber, administratorUsername, administratorPassword);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    builder.AppendLine(<span class="string">$"[CH<span class="subst">{index + <span class="number">1</span>}</span>]"</span>);</span><br><span class="line">    builder.AppendLine(<span class="string">$"Channel=<span class="subst">{channel.ChannelNumber}</span>"</span>);</span><br><span class="line">    builder.AppendLine(<span class="string">$"LowFreq=<span class="subst">{frequency}</span>000"</span>);</span><br><span class="line">    builder.AppendLine(<span class="string">$"HighFreq=<span class="subst">{frequency}</span>000"</span>);</span><br><span class="line">    builder.AppendLine(<span class="string">"Protocol=HTTP"</span>);</span><br><span class="line">    builder.AppendLine(<span class="string">$"URLGet=<span class="subst">{CreateStreamUri(server, channel.ChannelNumber, streamingUsername, streamingPassword)}</span>"</span>);</span><br><span class="line">    builder.AppendLine(<span class="string">"InternalPIDFiltering=N"</span>);</span><br><span class="line">    builder.AppendLine(<span class="string">"ExternalPIDFiltering=N"</span>);</span><br><span class="line">    builder.AppendLine(<span class="string">"Signal_Strength=95"</span>);</span><br><span class="line">    builder.AppendLine(<span class="string">"Signal_Quality=90"</span>);</span><br><span class="line">    builder.AppendLine(<span class="string">"Symbol_Quality=100"</span>);</span><br><span class="line">    builder.AppendLine(<span class="string">"Network_Rate=20000000"</span>);</span><br><span class="line">    builder.AppendLine();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">static</span> Uri <span class="title">CreateStreamUri</span>(<span class="params">Uri server, <span class="built_in">int</span> channel, <span class="built_in">string</span>? username, <span class="built_in">string</span>? password</span>)</span></span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">var</span> builder = <span class="keyword">new</span> UriBuilder(CreateAbsoluteUri(server, <span class="keyword">new</span> Uri(</span><br><span class="line">            <span class="string">$"stream/channelnumber/<span class="subst">{channel.ToString(CultureInfo.InvariantCulture)}</span>"</span> +</span><br><span class="line">            <span class="string">$"?profile=wmc-pass:<span class="subst">{channel.ToString(CultureInfo.InvariantCulture)}</span>"</span>, UriKind.Relative)))</span><br><span class="line">        {</span><br><span class="line">            UserName = username,</span><br><span class="line">            Password = password</span><br><span class="line">        };</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> builder.Uri;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (createChannels)</span><br><span class="line">{</span><br><span class="line">    mergedLineup.FullMerge(<span class="literal">true</span>);</span><br><span class="line">    mergedLineup.Update();</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">File.WriteAllText(<span class="string">"./HDHRProxyIPTV_MappingList.ini"</span>, builder.ToString());</span><br><span class="line"></span><br><span class="line">Console.WriteLine(<span class="string">"Done."</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">async</span> Task&lt;List&lt;(<span class="built_in">int</span> ChannelNumber, <span class="built_in">string</span> ChannelName)&gt;&gt; GetTvheadendChannelsAsync(</span><br><span class="line">    HttpClient client, Uri server, <span class="built_in">string</span>? username, <span class="built_in">string</span>? password)</span><br><span class="line">{</span><br><span class="line">    <span class="keyword">var</span> uri = CreateAbsoluteUri(server, <span class="keyword">new</span> Uri(<span class="string">"api/channel/grid"</span>, UriKind.Relative));</span><br><span class="line">    <span class="keyword">var</span> request = <span class="keyword">new</span> HttpRequestMessage(HttpMethod.Post, uri);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">string</span>.IsNullOrEmpty(username) &amp;&amp; !<span class="built_in">string</span>.IsNullOrEmpty(password))</span><br><span class="line">    {</span><br><span class="line">        request.Headers.Authorization = <span class="keyword">new</span> AuthenticationHeaderValue(<span class="string">"Basic"</span>, Convert.ToBase64String(</span><br><span class="line">            Encoding.ASCII.GetBytes(username + <span class="string">":"</span> + password)));</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> response = <span class="keyword">await</span> client.SendAsync(request);</span><br><span class="line">    response.EnsureSuccessStatusCode();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> payload = <span class="keyword">await</span> response.Content.ReadFromJsonAsync&lt;JsonElement&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> channels = <span class="keyword">new</span> List&lt;(<span class="built_in">int</span> ChannelNumber, <span class="built_in">string</span> ChannelName)&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">foreach</span> (<span class="keyword">var</span> channel <span class="keyword">in</span> payload.GetProperty(<span class="string">"entries"</span>).EnumerateArray())</span><br><span class="line">    {</span><br><span class="line">        channels.Add((</span><br><span class="line">            ChannelNumber: channel.GetProperty(<span class="string">"number"</span>).GetInt32(),</span><br><span class="line">            ChannelName: channel.GetProperty(<span class="string">"name"</span>).GetString()!));</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> channels.OrderBy(channel =&gt; channel.ChannelNumber).ToList();</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">async</span> Task&lt;List&lt;(<span class="built_in">string</span> ProfileUuid, <span class="built_in">string</span> ProfileName)&gt;&gt; GetTvheadendStreamProfiles(</span><br><span class="line">    HttpClient client, Uri server, <span class="built_in">string</span>? username, <span class="built_in">string</span>? password)</span><br><span class="line">{</span><br><span class="line">    <span class="keyword">var</span> uri = CreateAbsoluteUri(server, <span class="keyword">new</span> Uri(<span class="string">"api/profile/list"</span>, UriKind.Relative));</span><br><span class="line">    <span class="keyword">var</span> request = <span class="keyword">new</span> HttpRequestMessage(HttpMethod.Post, uri);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">string</span>.IsNullOrEmpty(username) &amp;&amp; !<span class="built_in">string</span>.IsNullOrEmpty(password))</span><br><span class="line">    {</span><br><span class="line">        request.Headers.Authorization = <span class="keyword">new</span> AuthenticationHeaderValue(<span class="string">"Basic"</span>, Convert.ToBase64String(</span><br><span class="line">            Encoding.ASCII.GetBytes(username + <span class="string">":"</span> + password)));</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> response = <span class="keyword">await</span> client.SendAsync(request);</span><br><span class="line">    response.EnsureSuccessStatusCode();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> payload = <span class="keyword">await</span> response.Content.ReadFromJsonAsync&lt;JsonElement&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> profiles = <span class="keyword">new</span> List&lt;(<span class="built_in">string</span> ProfileUuid, <span class="built_in">string</span> ProfileName)&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">foreach</span> (<span class="keyword">var</span> profile <span class="keyword">in</span> payload.GetProperty(<span class="string">"entries"</span>).EnumerateArray())</span><br><span class="line">    {</span><br><span class="line">        profiles.Add((</span><br><span class="line">            ProfileUuid: profile.GetProperty(<span class="string">"key"</span>).GetString()!,</span><br><span class="line">            ProfileName: profile.GetProperty(<span class="string">"val"</span>).GetString()!));</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> profiles;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">async</span> Task <span class="title">DeleteTvheadendStreamProfiles</span>(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="function">    HttpClient client, Uri server, <span class="built_in">string</span>? username, <span class="built_in">string</span>? password</span>)</span></span><br><span class="line">{</span><br><span class="line">    <span class="keyword">var</span> uri = CreateAbsoluteUri(server, <span class="keyword">new</span> Uri(<span class="string">"api/idnode/delete"</span>, UriKind.Relative));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">foreach</span> (<span class="function"><span class="keyword">var</span> profile <span class="keyword">in</span> <span class="keyword">await</span> <span class="title">GetTvheadendStreamProfiles</span>(<span class="params">client, server, username, password</span>))</span></span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">if</span> (!profile.ProfileName.StartsWith(<span class="string">"wmc-pass:"</span>))</span><br><span class="line">        {</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> request = <span class="keyword">new</span> HttpRequestMessage(HttpMethod.Post, uri);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">string</span>.IsNullOrEmpty(username) &amp;&amp; !<span class="built_in">string</span>.IsNullOrEmpty(password))</span><br><span class="line">        {</span><br><span class="line">            request.Headers.Authorization = <span class="keyword">new</span> AuthenticationHeaderValue(<span class="string">"Basic"</span>, Convert.ToBase64String(</span><br><span class="line">                Encoding.ASCII.GetBytes(username + <span class="string">":"</span> + password)));</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        request.Content = <span class="keyword">new</span> FormUrlEncodedContent(<span class="keyword">new</span> Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">string</span>&gt;</span><br><span class="line">        {</span><br><span class="line">            [<span class="string">"uuid"</span>] = profile.ProfileUuid</span><br><span class="line">        });</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> response = <span class="keyword">await</span> client.SendAsync(request);</span><br><span class="line">        response.EnsureSuccessStatusCode();</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">async</span> Task <span class="title">CreateTvheadendStreamProfile</span>(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="function">    HttpClient client, Uri server, <span class="built_in">int</span> identifier, <span class="built_in">string</span>? username, <span class="built_in">string</span>? password</span>)</span></span><br><span class="line">{</span><br><span class="line">    <span class="keyword">var</span> configuration = <span class="keyword">new</span> JsonObject</span><br><span class="line">    {</span><br><span class="line">        [<span class="string">"sid"</span>] = identifier,</span><br><span class="line">        [<span class="string">"rewrite_pmt"</span>] = <span class="literal">true</span>,</span><br><span class="line">        [<span class="string">"rewrite_pat"</span>] = <span class="literal">true</span>,</span><br><span class="line">        [<span class="string">"rewrite_sdt"</span>] = <span class="literal">true</span>,</span><br><span class="line">        [<span class="string">"rewrite_nit"</span>] = <span class="literal">true</span>,</span><br><span class="line">        [<span class="string">"rewrite_eit"</span>] = <span class="literal">true</span>,</span><br><span class="line">        [<span class="string">"name"</span>] = <span class="string">$"wmc-pass:<span class="subst">{identifier.ToString(CultureInfo.InvariantCulture)}</span>"</span>,</span><br><span class="line">        [<span class="string">"enabled"</span>] = <span class="literal">true</span>,</span><br><span class="line">        [<span class="string">"default"</span>] = <span class="literal">false</span>,</span><br><span class="line">        [<span class="string">"timeout"</span>] = <span class="number">0</span>,</span><br><span class="line">        [<span class="string">"priority"</span>] = <span class="number">3</span>,</span><br><span class="line">        [<span class="string">"fpriority"</span>] = <span class="number">0</span>,</span><br><span class="line">        [<span class="string">"restart"</span>] = <span class="literal">false</span>,</span><br><span class="line">        [<span class="string">"contaccess"</span>] = <span class="literal">true</span>,</span><br><span class="line">        [<span class="string">"catimeout"</span>] = <span class="number">2000</span>,</span><br><span class="line">        [<span class="string">"swservice"</span>] = <span class="literal">true</span>,</span><br><span class="line">        [<span class="string">"svfilter"</span>] = <span class="number">0</span></span><br><span class="line">    };</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> uri = CreateAbsoluteUri(server, <span class="keyword">new</span> Uri(<span class="string">"api/profile/create"</span>, UriKind.Relative));</span><br><span class="line">    <span class="keyword">var</span> request = <span class="keyword">new</span> HttpRequestMessage(HttpMethod.Post, uri);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">string</span>.IsNullOrEmpty(username) &amp;&amp; !<span class="built_in">string</span>.IsNullOrEmpty(password))</span><br><span class="line">    {</span><br><span class="line">        request.Headers.Authorization = <span class="keyword">new</span> AuthenticationHeaderValue(<span class="string">"Basic"</span>, Convert.ToBase64String(</span><br><span class="line">            Encoding.ASCII.GetBytes(username + <span class="string">":"</span> + password)));</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    request.Content = <span class="keyword">new</span> FormUrlEncodedContent(<span class="keyword">new</span> Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">string</span>&gt;</span><br><span class="line">    {</span><br><span class="line">        [<span class="string">"class"</span>] = <span class="string">"profile-mpegts"</span>,</span><br><span class="line">        [<span class="string">"conf"</span>] = configuration.ToJsonString()</span><br><span class="line">    });</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> response = <span class="keyword">await</span> client.SendAsync(request);</span><br><span class="line">    response.EnsureSuccessStatusCode();</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> Uri <span class="title">CreateAbsoluteUri</span>(<span class="params">Uri left, Uri right</span>)</span> =&gt; <span class="keyword">new</span>(left.AbsolutePath <span class="keyword">switch</span></span><br><span class="line">{</span><br><span class="line">    <span class="literal">null</span> <span class="keyword">or</span> { Length: <span class="number">0</span> } =&gt; <span class="keyword">new</span> UriBuilder(left) { Path = <span class="string">"/"</span> }.Uri,</span><br><span class="line">    <span class="built_in">string</span> path <span class="keyword">when</span> !path.EndsWith(<span class="string">"/"</span>) =&gt; <span class="keyword">new</span> UriBuilder(left) { Path = left.AbsolutePath + <span class="string">"/"</span> }.Uri,</span><br><span class="line">    _ =&gt; left</span><br><span class="line">}, right);</span><br></pre></td></tr></tbody></table></figure><p>If you're not familiar with .NET or don't want to compile it yourself, you can find the compiled executable here: <a href="/2023/07/05/connecting-windows-media-center-to-tvheadend-with-hdhrproxyiptv-an-alternative-to-dvblink/WmcChannels.zip" title="WmcChannels.zip">WmcChannels.zip</a>.</p><p>Using this program is trivial: run <code>WmcChannels.exe</code> and when prompted for the address of the Tvheadend server, enter the complete URL (e.g: <a target="_blank" rel="noopener" href="http://192.168.1.25:9981/">http://192.168.1.25:9981/</a>).</p><p>If everything was correctly configured, the message <code>Done</code> should appear and a <code>HDHRProxyIPTV_MappingList.ini</code> file should be added to the current directory. Copy it to the folder containing <code>HDHRProxyIPTV.exe</code> and restart the emulated HDHomeRun device.</p><p>You can now launch Windows Media Center and confirm the added channels work fine 😁</p></div><footer class="article-footer"><a data-url="https://kevinchalet.com/2023/07/05/connecting-windows-media-center-to-tvheadend-with-hdhrproxyiptv-an-alternative-to-dvblink/" data-id="clqqte8zg002l7gi1dqaodghd" class="article-share-link">Share</a> <a href="/2023/07/05/connecting-windows-media-center-to-tvheadend-with-hdhrproxyiptv-an-alternative-to-dvblink/#giscus_discussion" class="article-comment-link">Comments</a><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/dvblink/" rel="tag">dvblink</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hdhomerun/" rel="tag">hdhomerun</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hdhrproxytv/" rel="tag">hdhrproxytv</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/tv/" rel="tag">tv</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/tvheadend/" rel="tag">tvheadend</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/windows-media-center/" rel="tag">windows media center</a></li></ul></footer></div><nav id="article-nav"><a href="/2023/10/04/can-you-use-the-asp-net-core-identity-api-endpoints-with-openiddict/" id="article-nav-newer" class="article-nav-link-wrap"><strong class="article-nav-caption">Newer</strong><div class="article-nav-title">Can you use the ASP.NET Core Identity API endpoints with OpenIddict?</div></a><a href="/2023/02/27/introducing-system-integration-support-for-the-openiddict-client/" id="article-nav-older" class="article-nav-link-wrap"><strong class="article-nav-caption">Older</strong><div class="article-nav-title">Introducing system integration support for the OpenIddict client</div></a></nav></article><section id="comments"><div id="giscus_discussion"><script src="https://giscus.app/client.js" data-repo="kevinchalet/kevinchalet.github.io" data-repo-id="MDEwOlJlcG9zaXRvcnk2MTE2NjMwMw==" data-category="General" data-category-id="DIC_kwDOA6VS384CQu8O" data-mapping="og:title" data-strict="0" data-reactions-enabled="1" data-emit-metadata="1" data-input-position="bottom" data-theme="light" data-lang="en" data-loading="lazy" crossorigin="anonymous" async></script></div></section></section><aside id="sidebar"><div class="widget-wrap"><h3 class="widget-title">recents</h3><div class="widget"><ul id="recent-post" class="no-thumbnail"><li><div class="item-inner"><p class="item-title"><a href="/2023/12/18/openiddict-5-0-general-availability/" class="title">OpenIddict 5.0 general availability</a></p><p class="item-date"><time datetime="2023-12-18T16:00:00.000Z" itemprop="datePublished">2023-12-18</time></p></div></li><li><div class="item-inner"><p class="item-title"><a href="/2023/10/20/introducing-native-applications-per-client-token-lifetimes-and-client-assertions-support-in-openiddict-5-0-preview1/" class="title">Introducing native applications, per-client token lifetimes and client assertions support in OpenIddict 5.0 preview1</a></p><p class="item-date"><time datetime="2023-10-20T15:30:00.000Z" itemprop="datePublished">2023-10-20</time></p></div></li><li><div class="item-inner"><p class="item-title"><a href="/2023/10/04/can-you-use-the-asp-net-core-identity-api-endpoints-with-openiddict/" class="title">Can you use the ASP.NET Core Identity API endpoints with OpenIddict?</a></p><p class="item-date"><time datetime="2023-10-04T11:00:00.000Z" itemprop="datePublished">2023-10-04</time></p></div></li><li><div class="item-inner"><p class="item-title"><a href="/2023/07/05/connecting-windows-media-center-to-tvheadend-with-hdhrproxyiptv-an-alternative-to-dvblink/" class="title">Connecting Windows Media Center to Tvheadend with HDHRProxyIPTV: an alternative to DVBLink</a></p><p class="item-date"><time datetime="2023-07-05T18:00:00.000Z" itemprop="datePublished">2023-07-05</time></p></div></li><li><div class="item-inner"><p class="item-title"><a href="/2023/02/27/introducing-system-integration-support-for-the-openiddict-client/" class="title">Introducing system integration support for the OpenIddict client</a></p><p class="item-date"><time datetime="2023-02-27T16:00:00.000Z" itemprop="datePublished">2023-02-27</time></p></div></li></ul></div></div><div class="widget-wrap"><h3 class="widget-title">categories</h3><div class="widget"><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/development/">Development</a><span class="category-list-count">35</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/general/">General</a><span class="category-list-count">1</span></li></ul></div></div><div class="widget-wrap"><h3 class="widget-title">tags</h3><div class="widget"><ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/net/" rel="tag">.net</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/asp-net/" rel="tag">asp.net</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/asp-net-core/" rel="tag">asp.net core</a><span class="tag-list-count">33</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/asp-net-core-identity/" rel="tag">asp.net core identity</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/aspnet-contrib/" rel="tag">aspnet-contrib</a><span class="tag-list-count">27</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/auth0/" rel="tag">auth0</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/authentication/" rel="tag">authentication</a><span class="tag-list-count">39</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/azure/" rel="tag">azure</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/azure-ad/" rel="tag">azure ad</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cms/" rel="tag">cms</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/component-object-model/" rel="tag">component object model</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dvblink/" rel="tag">dvblink</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/github/" rel="tag">github</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hdhomerun/" rel="tag">hdhomerun</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hdhrproxytv/" rel="tag">hdhrproxytv</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/identity/" rel="tag">identity</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jwt/" rel="tag">jwt</a><span class="tag-list-count">34</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/manifest/" rel="tag">manifest</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/oauth/" rel="tag">oauth</a><span class="tag-list-count">39</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/okta/" rel="tag">okta</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/openid/" rel="tag">openid</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/openid-connect/" rel="tag">openid connect</a><span class="tag-list-count">38</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/openiddict/" rel="tag">openiddict</a><span class="tag-list-count">24</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/orchard/" rel="tag">orchard</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/orchardcore/" rel="tag">orchardcore</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/owin/" rel="tag">owin</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/razor/" rel="tag">razor</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tls/" rel="tag">tls</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tv/" rel="tag">tv</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tvheadend/" rel="tag">tvheadend</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/uwp/" rel="tag">uwp</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vulnerability/" rel="tag">vulnerability</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web-authentication-broker/" rel="tag">web authentication broker</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web-providers/" rel="tag">web providers</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/windows/" rel="tag">windows</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/windows-10/" rel="tag">windows 10</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/windows-media-center/" rel="tag">windows media center</a><span class="tag-list-count">2</span></li></ul></div></div><div class="widget-wrap"><h3 class="widget-title">archives</h3><div class="widget"><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/12/">December 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/10/">October 2023</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/07/">July 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/02/">February 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/12/">December 2022</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">June 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">February 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">May 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">December 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">November 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">June 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">February 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">January 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">November 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">August 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">July 2016</a><span class="archive-list-count">9</span></li></ul></div></div></aside></div><footer id="footer"><div class="outer"><div id="footer-info" class="inner">&copy; 2016 - 2023 Kévin Chalet<br>Proudly powered by <a href="http://hexo.io/" target="_blank">Hexo</a> with <a href="http://github.com/ppoffice" target="_blank">Ruipeng Zhang</a>'s <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank">Icarus theme</a> and <a href="https://www.flickr.com/photos/madison_slater/" target="_blank">Madison Slater</a>'s <a href="https://www.flickr.com/photos/madison_slater/11299339856/" target="_blank">photos</a>.</div></div></footer><script src="/js/jquery.js"></script><script src="/js/script.js"></script></div></body></html>