<!DOCTYPE html><html><head><meta charset="utf-8"><title>Kévin Chalet&#39;s blog</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta property="og:type" content="website"><meta property="og:title" content="Kévin Chalet&#39;s blog"><meta property="og:url" content="https://kevinchalet.com/page/4/index.html"><meta property="og:site_name" content="Kévin Chalet&#39;s blog"><meta property="og:locale" content="en_US"><meta property="article:author" content="Kévin Chalet"><meta name="twitter:card" content="summary"><meta name="twitter:creator" content="@kevin_chalet"><link rel="icon" href="https://kevinchalet.com/assets/photo.png"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css"><script type="text/javascript">!function(e,a,t,n,g,c,o){e.GoogleAnalyticsObject=g,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),o=a.getElementsByTagName(t)[0],c.async=1,c.src="//www.google-analytics.com/analytics.js",o.parentNode.insertBefore(c,o)}(window,document,"script",0,"ga"),ga("create","UA-79360312-1","auto"),ga("send","pageview")</script><meta name="generator" content="Hexo 6.2.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head><body><div id="container"><header id="header"><div id="header-main" class="header-inner"><div class="outer"><a href="/" id="logo"><span class="site-title">Kévin Chalet&#39;s blog</span></a><nav id="main-nav"><a class="main-nav-link" href="/.">Home</a> <a class="main-nav-link" href="/archives/">Archives</a></nav><nav id="sub-nav"><div class="profile" id="profile-nav"><a id="profile-anchor" href="javascript:;"><img class="avatar" src="https://kevinchalet.com/assets/photo.png"><i class="fa fa-caret-down"></i></a></div></nav><div id="search-form-wrap"><form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit"></button><input type="hidden" name="sitesearch" value="https://kevinchalet.com"></form></div></div></div></header><div class="outer"><aside id="profile"><div class="inner profile-inner"><div class="base-info profile-block"><img id="avatar" src="https://kevinchalet.com/assets/photo.png"><h2 id="name">Kévin Chalet</h2><h3 id="title">.NET-holic and OpenID-addict MVP in the wild.</h3><span id="location"><i class="fa fa-map-marker"></i>France</span> <a id="follow" target="_blank" rel="noopener" href="https://twitter.com/intent/user?screen_name=kevin_chalet"><i class="fa fa-twitter fa-lg"></i> Follow me on Twitter</a></div><div class="article-info profile-block"><div class="article-info-block">44 <span>posts</span></div><div class="article-info-block">37 <span>tags</span></div></div><div class="contact-info profile-block"><table class="contact-list"><tr><td><a href="mailto:contact@kevinchalet.com" title="Email"><i class="fa fa-envelope"></i></a></td><td><a target="_blank" rel="noopener" href="https://www.linkedin.com/in/kevinchalet/" title="LinkedIn"><i class="fa fa-linkedin"></i></a></td><td><a target="_blank" rel="noopener" href="https://github.com/kevinchalet" title="GitHub"><i class="fa fa-github"></i></a></td><td><a target="_blank" rel="noopener" href="https://twitter.com/kevin_chalet" title="Twitter"><i class="fa fa-twitter"></i></a></td><td><a target="_blank" rel="noopener" href="https://stackoverflow.com/users/542757/k%c3%a9vin-chalet" title="StackOverflow"><i class="fa fa-stack-overflow"></i></a></td><td><a target="_blank" rel="noopener" href="https://mvp.microsoft.com/fr-fr/PublicProfile/5001682" title="Microsoft MVP"><i class="fa fa-windows"></i></a></td><td><a href="/atom.xml" title="RSS"><i class="fa fa-rss"></i></a></td></tr></table></div></div></aside><section id="main"><article id="post-introducing-openiddict-3-0-beta1" class="article article-type-post" itemscope itemprop="blogPost"><div class="article-inner"><header class="article-header"><h1 itemprop="name"><a class="article-title" href="/2020/06/11/introducing-openiddict-3-0-beta1/">Introducing OpenIddict 3.0 beta1</a></h1><div class="article-meta"><div class="article-date"><i class="fa fa-calendar"></i> <a href="/2020/06/11/introducing-openiddict-3-0-beta1/"><time datetime="2020-06-11T19:00:00.000Z" itemprop="datePublished">2020-06-11</time></a></div></div></header><div class="article-entry" itemprop="articleBody"><p>For over a year now, <strong>I've been working on what is for me the most exciting OpenIddict release: OpenIddict 3.0 beta1</strong>, whose server and validation features have been almost completely rewritten. You can find all the 3.0 beta1 packages on <a target="_blank" rel="noopener" href="https://www.nuget.org/profiles/openiddict">NuGet.org</a>.</p><h2 id="What-changed"><a href="#What-changed" class="headerlink" title="What changed?"></a>What changed?</h2><p>Some of the major changes introduced in this release were described in the <a target="_blank" rel="noopener" href="https://github.com/openiddict/openiddict-core/issues/736">OpenIddict 3.0 roadmap</a> (the detailed list <a target="_blank" rel="noopener" href="https://github.com/openiddict/openiddict-core/issues?q=milestone:3.0.0-beta1">can be found on GitHub</a>), but here's a recap of the most important ones:</p><h3 id="The-aspnet-contrib-OAuth-2-0-server-x2F-validation-x2F-introspection-handlers-and-OpenIddict-were-merged-into-a-single-codebase"><a href="#The-aspnet-contrib-OAuth-2-0-server-x2F-validation-x2F-introspection-handlers-and-OpenIddict-were-merged-into-a-single-codebase" class="headerlink" title="The aspnet-contrib OAuth 2.0 server/validation/introspection handlers and OpenIddict were merged into a single codebase"></a>The aspnet-contrib OAuth 2.0 server/validation/introspection handlers and OpenIddict were merged into a single codebase</h3><p><strong>This is the most important change of this release</strong>: ASOS – the low-level OpenID Connect server framework used in OpenIddict 1.0/2.0 – and the aspnet-contrib validation and introspection middleware were all merged into OpenIddict.</p><p>To ensure OpenIddict can be used as a replacement for ASOS (for which people usually write their own persistence layer, at least to validate things like <code>client_id</code> and <code>redirect_uri</code>), a new degraded mode was introduced to allow using the OpenIddict server components without all the additional logic that relies on the OpenIddict managers/stores (e.g client authentication, client validation, token storage).</p><p>For more information about this feature, read my previous post:</p><a href="/2020/02/18/creating-an-openid-connect-server-proxy-with-openiddict-3-0-s-degraded-mode/" title="Creating an OpenID Connect server proxy with OpenIddict 3.0's degraded mode">Creating an OpenID Connect server proxy with OpenIddict 3.0's degraded mode</a>.<h3 id="OpenIddict-has-been-decoupled-from-ASP-NET-Core-and-now-natively-supports-OWIN-x2F-Katana-and-ASP-NET-4-x"><a href="#OpenIddict-has-been-decoupled-from-ASP-NET-Core-and-now-natively-supports-OWIN-x2F-Katana-and-ASP-NET-4-x" class="headerlink" title="OpenIddict has been decoupled from ASP.NET Core and now natively supports OWIN/Katana and ASP.NET 4.x"></a>OpenIddict has been decoupled from ASP.NET Core and now natively supports OWIN/Katana and ASP.NET 4.x</h3><p>In OpenIddict 1.0/2.0, the core and the EF 6/EF Core/MongoDB stores were already decoupled from ASP.NET Core. <strong>In 3.0, the server and validation features have been revamped to avoid depending on ASP.NET Core</strong>. Instead, ASP.NET Core integration is now provided by separate packages named <code>OpenIddict.Server.AspNetCore</code> and <code>OpenIddict.Validation.AspNetCore</code>. For convenience, a metapackage named <code>OpenIddict.AspNetCore</code> can be referenced to import the OpenIddict core, server and validation packages and their ASP.NET Core integration with a single <code>PackageReference</code>.</p><p>Unlike the previous versions, <strong>OpenIddict 3.0 will also support multiple ASP.NET Core versions: 2.1, 3.1 and 5.0</strong>.</p><p>Decoupling OpenIddict from ASP.NET Core was also a great opportunity to make it natively compatible with OWIN/Katana, <strong>which will allow using its server or validation features in any ASP.NET (non-core) 4.6.1 application</strong>. OWIN/Katana integration is provided by the <code>OpenIddict.Server.Owin</code> and <code>OpenIddict.Validation.Owin</code> packages, which follows the same pattern as the ASP.NET Core hosts.</p><p>Here's the framework/runtime combinations that will be officially supported in 3.0:</p><table><thead><tr><th>Web framework version</th><th>.NET runtime version</th></tr></thead><tbody><tr><td>ASP.NET Core 2.1</td><td>.NET Framework 4.6.1</td></tr><tr><td>ASP.NET Core 2.1</td><td>.NET Framework 4.7.2</td></tr><tr><td>ASP.NET Core 2.1</td><td>.NET Framework 4.8</td></tr><tr><td>ASP.NET Core 2.1</td><td>.NET Core 2.1</td></tr><tr><td></td><td></td></tr><tr><td>ASP.NET Core 3.1</td><td>.NET Core 3.1</td></tr><tr><td></td><td></td></tr><tr><td>ASP.NET Core 5.0</td><td>.NET 5.0</td></tr><tr><td></td><td></td></tr><tr><td>OWIN/Katana 4.1</td><td>.NET Framework 4.6.1</td></tr><tr><td>OWIN/Katana 4.1</td><td>.NET Framework 4.7.2</td></tr><tr><td>OWIN/Katana 4.1</td><td>.NET Framework 4.8</td></tr></tbody></table><p>For more information about OWIN/Katana and ASP.NET 4.x support, read this dedicated post:</p><a href="/2020/03/03/adding-openiddict-3-0-to-an-owin-application/" title="Adding OpenIddict 3.0 to an OWIN application">Adding OpenIddict 3.0 to an OWIN application</a>.<p class="article-more-link"><a href="/2020/06/11/introducing-openiddict-3-0-beta1/">Read more</a></p></div><footer class="article-footer"><a data-url="https://kevinchalet.com/2020/06/11/introducing-openiddict-3-0-beta1/" data-id="clnubsw8n002kggi17k2bay97" class="article-share-link">Share</a> <a href="/2020/06/11/introducing-openiddict-3-0-beta1/#giscus_discussion" class="article-comment-link">Comments</a><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/authentication/" rel="tag">authentication</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/jwt/" rel="tag">jwt</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/oauth/" rel="tag">oauth</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/openid-connect/" rel="tag">openid connect</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/openiddict/" rel="tag">openiddict</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/owin/" rel="tag">owin</a></li></ul></footer></div></article><article id="post-adding-openiddict-3-0-to-an-owin-application" class="article article-type-post" itemscope itemprop="blogPost"><div class="article-inner"><header class="article-header"><h1 itemprop="name"><a class="article-title" href="/2020/03/03/adding-openiddict-3-0-to-an-owin-application/">Adding OpenIddict 3.0 to an OWIN application</a></h1><div class="article-meta"><div class="article-date"><i class="fa fa-calendar"></i> <a href="/2020/03/03/adding-openiddict-3-0-to-an-owin-application/"><time datetime="2020-03-03T18:00:00.000Z" itemprop="datePublished">2020-03-03</time></a></div></div></header><div class="article-entry" itemprop="articleBody"><div class="note tip"><p>Up-to-date samples for ASP.NET 4.x and OWIN can be found in the <a target="_blank" rel="noopener" href="https://github.com/openiddict/openiddict-samples">openiddict/openiddict-samples</a> repository:</p><ul><li><a target="_blank" rel="noopener" href="https://github.com/openiddict/openiddict-samples/tree/dev/samples/Fornax">Fornax</a>: authorization code flow demo using ASP.NET Web Forms 4.8 and OWIN/Katana, with a .NET console acting as the client.</li><li><a target="_blank" rel="noopener" href="https://github.com/openiddict/openiddict-samples/tree/dev/samples/Kalarba">Kalarba</a>: resource owner password credentials demo using OWIN/Katana, ASP.NET Web API and the OpenIddict degraded mode.</li></ul></div><p>Last year, <strong>I announced that OpenIddict would become compatible with OWIN/Katana – and thus usable in any ASP.NET 4.x <em>non-Core</em> application –</strong> as part of the 3.0 release. While using OpenIddict in an OWIN application shouldn't be much different than using it in an ASP.NET Core application, <strong>there's actually a part than will slightly differ between the two platforms: dependency injection</strong>.</p><p>Globally introduced in ASP.NET Core 1.0, <strong>dependency injection support was not a thing in OWIN</strong>. Yet, OpenIddict itself depends on dependency injection for all its features: core, server and token validation. To work around the lack of official DI support, <strong>OpenIddict 3.0 will support two approaches: one working with the Autofac DI container and one without</strong>. This blog post briefly describes how to do that.</p><p>To keep things simple, we'll create a tiny self-hosted .NET 4.7.2 OWIN application, but of course, these 2 approaches also work in any ASP.NET application, no matter what's the host used: <code>HttpListener</code>, <code>System.Web</code> or even third-party options like <code>Nowin</code>.</p><p>For that, create a new application with the following <code>.csproj</code>, that contains the basic things we'll need: the Microsoft DI primitives used by OpenIddict, the OWIN self-host and hosting abstractions and the OpenIddict OWIN metapackage (that itself references the core, server and validation packages, plus the OWIN integration assembly):</p><figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Project</span> <span class="attr">Sdk</span>=<span class="string">"Microsoft.NET.Sdk"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">PropertyGroup</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">OutputType</span>&gt;</span>Exe<span class="tag">&lt;/<span class="name">OutputType</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">TargetFramework</span>&gt;</span>net472<span class="tag">&lt;/<span class="name">TargetFramework</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">PropertyGroup</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">ItemGroup</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">PackageReference</span> <span class="attr">Include</span>=<span class="string">"Microsoft.Extensions.DependencyInjection"</span> <span class="attr">Version</span>=<span class="string">"3.1.4"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">PackageReference</span> <span class="attr">Include</span>=<span class="string">"Microsoft.Owin.Host.HttpListener"</span> <span class="attr">Version</span>=<span class="string">"4.1.0"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">PackageReference</span> <span class="attr">Include</span>=<span class="string">"Microsoft.Owin.Hosting"</span> <span class="attr">Version</span>=<span class="string">"4.1.0"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">PackageReference</span> <span class="attr">Include</span>=<span class="string">"OpenIddict.Owin"</span> <span class="attr">Version</span>=<span class="string">"3.0.0-beta1.20311.67"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">ItemGroup</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">Project</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p class="article-more-link"><a href="/2020/03/03/adding-openiddict-3-0-to-an-owin-application/">Read more</a></p></div><footer class="article-footer"><a data-url="https://kevinchalet.com/2020/03/03/adding-openiddict-3-0-to-an-owin-application/" data-id="clnubsw8l0029ggi17tec293f" class="article-share-link">Share</a> <a href="/2020/03/03/adding-openiddict-3-0-to-an-owin-application/#giscus_discussion" class="article-comment-link">Comments</a><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/authentication/" rel="tag">authentication</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/jwt/" rel="tag">jwt</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/oauth/" rel="tag">oauth</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/openid-connect/" rel="tag">openid connect</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/openiddict/" rel="tag">openiddict</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/owin/" rel="tag">owin</a></li></ul></footer></div></article><article id="post-creating-an-openid-connect-server-proxy-with-openiddict-3-0-s-degraded-mode" class="article article-type-post" itemscope itemprop="blogPost"><div class="article-inner"><header class="article-header"><h1 itemprop="name"><a class="article-title" href="/2020/02/18/creating-an-openid-connect-server-proxy-with-openiddict-3-0-s-degraded-mode/">Creating an OpenID Connect server proxy with OpenIddict 3.0&#39;s degraded mode</a></h1><div class="article-meta"><div class="article-date"><i class="fa fa-calendar"></i> <a href="/2020/02/18/creating-an-openid-connect-server-proxy-with-openiddict-3-0-s-degraded-mode/"><time datetime="2020-02-18T15:30:00.000Z" itemprop="datePublished">2020-02-18</time></a></div></div></header><div class="article-entry" itemprop="articleBody"><p>As some of you may already know, <a target="_blank" rel="noopener" href="https://github.com/openiddict/openiddict-core/issues/736">I've been working on OpenIddict 3.0 for a few months now</a>. <strong>One of the main goals of this major release is to merge <a target="_blank" rel="noopener" href="https://github.com/aspnet-contrib/AspNet.Security.OpenIdConnect.Server">ASOS</a></strong> (a low-level OpenID Connect server middleware for ASP.NET Core) <strong>and OpenIddict</strong> (a higher-level OIDC server library designed for less advanced users) into a unified code base, that would ideally represent the best of both worlds.</p><p><strong>As part of this task, a new feature was added to OpenIddict: the degraded mode</strong> (also known as the <em>ASOS-like</em> or <em>bare</em> mode). Put simply, <strong>this mode allows using OpenIddict's server without any backing database</strong>. Once enabled, all the features that rely on the OpenIddict application, authorization, scope and token managers (contained in the <code>OpenIddict.Core</code> package) are automatically disabled, which includes things like <code>client_id</code>/<code>client_secret</code> or <code>redirect_uri</code> validation, reference tokens and token revocation support. In other words, this mode allows switching from an "all you can eat" offer to a "pay-to-play" approach.</p><p>A thread, posted on <a target="_blank" rel="noopener" href="https://github.com/aspnet-contrib/AspNet.Security.OpenId.Providers/issues/50">one of the aspnet-contrib repositories</a> gave me a perfect opportunity to showcase this particular feature. The question asked by the commenters was simple: how can I use an external authentication provider like Steam (that implements the legacy OpenID 2.0 protocol) with my own API endpoints?</p><p><strong>Steam doesn't issue any access token you could directly use with your API endpoints</strong>. Actually, access tokens are not even a thing in OpenID 2.0, which is a pure authentication protocol that doesn't offer any authorization capability (unlike OAuth 1.0/2.0 or OpenID Connect).</p><p>So, how do we solve this problem? <strong>The most common approach typically consists in creating your own authorization server</strong> between your frontend application and the remote authentication provider (here, Steam). This way, when the application needs to authenticate a user, the user is redirected to the authorization server, that delegates the actual authentication part to another party. Once authenticated by that party, the user is redirected back to the main authorization server, that issues an access token to the client application.</p><img src="/2020/02/18/creating-an-openid-connect-server-proxy-with-openiddict-3-0-s-degraded-mode/authorization-code-flow.png"><p>This a super common scenario, that can be implemented using standard protocols like OpenID Connect and well-known implementations like OpenIddict or IdentityServer. However, <a target="_blank" rel="noopener" href="https://github.com/aspnet-contrib/AspNet.Security.OpenId.Providers/issues/50#issuecomment-586734467">these options are sometimes considered "overkill" for such simple scenarios</a>. After all, why would you need a fully-fledged OIDC server – with login, registration or consent views – when all you want is to delegate the actual authentication to another server in a totally transparent and almost invisible way?</p><p>Rolling your own protocol is tempting... <a target="_blank" rel="noopener" href="https://github.com/aspnet-contrib/AspNet.Security.OpenId.Providers/issues/50#issuecomment-586726240">but a very bad idea</a>, as you can't benefit from all the security measures offered by standard flows like OAuth 2.0/OpenID Connect's authorization code flow, whose threat model is clearly identified for many years now. <strong>As you may have guessed by now, this is precisely where OpenIddict 3.0's degraded mode can come in handy</strong>.</p><p class="article-more-link"><a href="/2020/02/18/creating-an-openid-connect-server-proxy-with-openiddict-3-0-s-degraded-mode/">Read more</a></p></div><footer class="article-footer"><a data-url="https://kevinchalet.com/2020/02/18/creating-an-openid-connect-server-proxy-with-openiddict-3-0-s-degraded-mode/" data-id="clnubsw8m002gggi16psshchr" class="article-share-link">Share</a> <a href="/2020/02/18/creating-an-openid-connect-server-proxy-with-openiddict-3-0-s-degraded-mode/#giscus_discussion" class="article-comment-link">Comments</a><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/asp-net-core/" rel="tag">asp.net core</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/aspnet-contrib/" rel="tag">aspnet-contrib</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/authentication/" rel="tag">authentication</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/jwt/" rel="tag">jwt</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/oauth/" rel="tag">oauth</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/openid-connect/" rel="tag">openid connect</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/openiddict/" rel="tag">openiddict</a></li></ul></footer></div></article><article id="post-forcing-an-old-net-application-to-support-tls-1-2-without-recompiling-it" class="article article-type-post" itemscope itemprop="blogPost"><div class="article-inner"><header class="article-header"><h1 itemprop="name"><a class="article-title" href="/2019/04/11/forcing-an-old-net-application-to-support-tls-1-2-without-recompiling-it/">Forcing an old .NET application to support TLS 1.2 without recompiling it</a></h1><div class="article-meta"><div class="article-date"><i class="fa fa-calendar"></i> <a href="/2019/04/11/forcing-an-old-net-application-to-support-tls-1-2-without-recompiling-it/"><time datetime="2019-04-11T15:30:00.000Z" itemprop="datePublished">2019-04-11</time></a></div></div></header><div class="article-entry" itemprop="articleBody"><p>As most servers are moving toward TLS 1.3 and removing TLS 1.0/1.1 support, examples of legacy .NET applications – compiled with an old version of the .NET Framework, like 4.0 or 4.5 – experiencing connectivity issues with TLS 1.2 servers are becoming more and more common, specially since installing a more recent version of the .NET Framework is not sufficient: <strong>it's the version used for compiling your project that actually matters</strong> when it comes to selecting the supported TLS versions during the TLS handshake.</p><p>To make migration a bit less painful, <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/dotnet/framework/network-programming/tls">Microsoft published a "transport security best practices" paper</a> that list a few solutions that help avoid handshake errors related to the use of legacy TLS versions that are no longer considered safe.</p><p><strong>One of the proposed solutions is to update your project to target .NET Framework 4.7</strong>: in this case, you'll have nothing else to do, as .NET 4.7 applications automatically default to whatever the operating system they run on offers and considers safe (which currently includes TLS 1.2 and will later include TLS 1.3).</p><p>Unfortunately, such an option requires re-compiling the application, which is not always feasible. Thankfully, you can also force an existing application to use the system default TLS versions without having to re-compile it (assuming it doesn't explicitly set the SSL/TLS versions it prefers via <code>ServicePointManager</code>).</p><p>The best practices paper lists a few options, but my favourite one is the one that consists in <strong>simply updating the configuration file associated with the application executable</strong>, as it's easy to do and doesn't impact anything else on the machine.</p><p>For that, <strong>locate the configuration file associated to the executable</strong> of the application you want to add TLS 1.2 support to: it's always named <code>[name of the executable].exe.config</code>. If there's no such file, create one. Once located or created, <strong>update its content to enable the compatibility switch required to support TLS 1.2</strong>:</p><figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"utf-8"</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">runtime</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">AppContextSwitchOverrides</span> <span class="attr">value</span>=<span class="string">"Switch.System.Net.DontEnableSystemDefaultTlsVersions=false"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">runtime</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><div class="note tip"><p>If you're still using Windows 7, you'll also have to tweak the registry to enable TLS 1.2 support, as indicated on <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/windows-server/security/tls/tls-registry-settings">https://docs.microsoft.com/en-us/windows-server/security/tls/tls-registry-settings</a>.</p></div></div><footer class="article-footer"><a data-url="https://kevinchalet.com/2019/04/11/forcing-an-old-net-application-to-support-tls-1-2-without-recompiling-it/" data-id="clnubsw8d0017ggi13anlcscx" class="article-share-link">Share</a> <a href="/2019/04/11/forcing-an-old-net-application-to-support-tls-1-2-without-recompiling-it/#giscus_discussion" class="article-comment-link">Comments</a><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/net/" rel="tag">.net</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/tls/" rel="tag">tls</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/windows/" rel="tag">windows</a></li></ul></footer></div></article><article id="post-openiddict-1-0-and-2-0-general-availability" class="article article-type-post" itemscope itemprop="blogPost"><div class="article-inner"><header class="article-header"><h1 itemprop="name"><a class="article-title" href="/2018/11/01/openiddict-1-0-and-2-0-general-availability/">OpenIddict 1.0 and 2.0 general availability</a></h1><div class="article-meta"><div class="article-date"><i class="fa fa-calendar"></i> <a href="/2018/11/01/openiddict-1-0-and-2-0-general-availability/"><time datetime="2018-11-01T20:00:00.000Z" itemprop="datePublished">2018-11-01</time></a></div><div class="article-category"><i class="fa fa-folder"></i> <a class="article-category-link" href="/categories/development/">Development</a></div></div></header><div class="article-entry" itemprop="articleBody"><p>I'm very happy to announce that <strong>OpenIddict 1.0 and 2.0 final packages were pushed earlier today</strong> to <a target="_blank" rel="noopener" href="https://www.nuget.org/profiles/openiddict">NuGet.org</a> and are now officially available!</p><h2 id="What-changed-since-RC3"><a href="#What-changed-since-RC3" class="headerlink" title="What changed since RC3?"></a>What changed since RC3?</h2><h3 id="A-security-bug-was-fixed"><a href="#A-security-bug-was-fixed" class="headerlink" title="A security bug was fixed"></a>A security bug was fixed</h3><p>A few days ago, <a target="_blank" rel="noopener" href="https://github.com/openiddict/openiddict-core/issues/682"><strong>a vulnerability impacting application permissions was publicly reported</strong></a> by <a target="_blank" rel="noopener" href="https://github.com/nurhat">nurhat</a> on GitHub (many thanks to him!).</p><p>In a nutshell, <strong>scope permissions were not correctly enforced for public clients</strong> using the password flow and custom grant types (confidential clients or clients using the code or client credentials flows were not impacted).</p><p><strong>A fix was immediately added to the nightly builds and is present in the RTM release</strong>.</p><h3 id="Built-in-entity-caches-are-now-included"><a href="#Built-in-entity-caches-are-now-included" class="headerlink" title="Built-in entity caches are now included"></a>Built-in entity caches are now included</h3><p><strong>OpenIddict now comes with built-in entity caching</strong> to avoid having to send multiple requests to retrieve the same entities. Concretely, if your <code>AuthorizationController</code> uses APIs like <code>OpenIddictApplicationManager.FindByClientIdAsync(request.ClientId)</code>, the corresponding application will be directly retrieved from the cache and the resulting operation will be extremely cheap.</p><p>To ensure this feature works with non-thread-safe stores and stores that rely on context-affinity (like Entity Framework 6.x or Entity Framework Core), these built-in caches are scoped so that cached entities are not reused across requests.</p><p>While definitely not recommended, this feature can be disabled via the OpenIddict core options:</p><figure class="highlight csharp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">services.AddOpenIddict()</span><br><span class="line">    .AddCore(options =&gt;</span><br><span class="line">    {</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">        options.DisableEntityCaching();</span><br><span class="line">    })</span><br></pre></td></tr></tbody></table></figure><p class="article-more-link"><a href="/2018/11/01/openiddict-1-0-and-2-0-general-availability/">Read more</a></p></div><footer class="article-footer"><a data-url="https://kevinchalet.com/2018/11/01/openiddict-1-0-and-2-0-general-availability/" data-id="clnubsw8c0010ggi11ldi50to" class="article-share-link">Share</a> <a href="/2018/11/01/openiddict-1-0-and-2-0-general-availability/#giscus_discussion" class="article-comment-link">Comments</a><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/asp-net-core/" rel="tag">asp.net core</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/aspnet-contrib/" rel="tag">aspnet-contrib</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/authentication/" rel="tag">authentication</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/jwt/" rel="tag">jwt</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/oauth/" rel="tag">oauth</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/openid-connect/" rel="tag">openid connect</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/openiddict/" rel="tag">openiddict</a></li></ul></footer></div></article><nav id="page-nav"><a class="extend prev" rel="prev" href="/page/3/">&amp;laquo; Prev</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><a class="page-number" href="/page/6/">6</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><a class="extend next" rel="next" href="/page/5/">Next &amp;raquo;</a></nav></section><aside id="sidebar"><div class="widget-wrap"><h3 class="widget-title">recents</h3><div class="widget"><ul id="recent-post" class="no-thumbnail"><li><div class="item-inner"><p class="item-title"><a href="/2023/10/04/can-you-use-the-asp-net-core-identity-api-endpoints-with-openiddict/" class="title">Can you use the ASP.NET Core Identity API endpoints with OpenIddict?</a></p><p class="item-date"><time datetime="2023-10-04T11:00:00.000Z" itemprop="datePublished">2023-10-04</time></p></div></li><li><div class="item-inner"><p class="item-title"><a href="/2023/07/05/connecting-windows-media-center-to-tvheadend-with-hdhrproxyiptv-an-alternative-to-dvblink/" class="title">Connecting Windows Media Center to Tvheadend with HDHRProxyIPTV: an alternative to DVBLink</a></p><p class="item-date"><time datetime="2023-07-05T18:00:00.000Z" itemprop="datePublished">2023-07-05</time></p></div></li><li><div class="item-inner"><p class="item-title"><a href="/2023/02/27/introducing-system-integration-support-for-the-openiddict-client/" class="title">Introducing system integration support for the OpenIddict client</a></p><p class="item-date"><time datetime="2023-02-27T16:00:00.000Z" itemprop="datePublished">2023-02-27</time></p></div></li><li><div class="item-inner"><p class="item-title"><a href="/2022/12/23/openiddict-4-0-general-availability/" class="title">OpenIddict 4.0 general availability</a></p><p class="item-date"><time datetime="2022-12-23T20:00:00.000Z" itemprop="datePublished">2022-12-23</time></p></div></li><li><div class="item-inner"><p class="item-title"><a href="/2022/12/16/getting-started-with-the-openiddict-web-providers/" class="title">Getting started with the OpenIddict web providers</a></p><p class="item-date"><time datetime="2022-12-16T15:00:00.000Z" itemprop="datePublished">2022-12-16</time></p></div></li></ul></div></div><div class="widget-wrap"><h3 class="widget-title">categories</h3><div class="widget"><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/development/">Development</a><span class="category-list-count">33</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/general/">General</a><span class="category-list-count">1</span></li></ul></div></div><div class="widget-wrap"><h3 class="widget-title">tags</h3><div class="widget"><ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/net/" rel="tag">.net</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/asp-net/" rel="tag">asp.net</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/asp-net-core/" rel="tag">asp.net core</a><span class="tag-list-count">31</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/asp-net-core-identity/" rel="tag">asp.net core identity</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/aspnet-contrib/" rel="tag">aspnet-contrib</a><span class="tag-list-count">25</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/auth0/" rel="tag">auth0</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/authentication/" rel="tag">authentication</a><span class="tag-list-count">37</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/azure/" rel="tag">azure</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/azure-ad/" rel="tag">azure ad</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cms/" rel="tag">cms</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/component-object-model/" rel="tag">component object model</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dvblink/" rel="tag">dvblink</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/github/" rel="tag">github</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hdhomerun/" rel="tag">hdhomerun</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hdhrproxytv/" rel="tag">hdhrproxytv</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/identity/" rel="tag">identity</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jwt/" rel="tag">jwt</a><span class="tag-list-count">32</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/manifest/" rel="tag">manifest</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/oauth/" rel="tag">oauth</a><span class="tag-list-count">37</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/okta/" rel="tag">okta</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/openid/" rel="tag">openid</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/openid-connect/" rel="tag">openid connect</a><span class="tag-list-count">36</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/openiddict/" rel="tag">openiddict</a><span class="tag-list-count">22</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/orchard/" rel="tag">orchard</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/orchardcore/" rel="tag">orchardcore</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/owin/" rel="tag">owin</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/razor/" rel="tag">razor</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tls/" rel="tag">tls</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tv/" rel="tag">tv</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tvheadend/" rel="tag">tvheadend</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/uwp/" rel="tag">uwp</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vulnerability/" rel="tag">vulnerability</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web-authentication-broker/" rel="tag">web authentication broker</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web-providers/" rel="tag">web providers</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/windows/" rel="tag">windows</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/windows-10/" rel="tag">windows 10</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/windows-media-center/" rel="tag">windows media center</a><span class="tag-list-count">2</span></li></ul></div></div><div class="widget-wrap"><h3 class="widget-title">archives</h3><div class="widget"><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/10/">October 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/07/">July 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/02/">February 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/12/">December 2022</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">June 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">February 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">May 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">December 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">November 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">June 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">February 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">January 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">November 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">August 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">July 2016</a><span class="archive-list-count">9</span></li></ul></div></div></aside></div><footer id="footer"><div class="outer"><div id="footer-info" class="inner">&copy; 2016 - 2023 Kévin Chalet<br>Proudly powered by <a href="http://hexo.io/" target="_blank">Hexo</a> with <a href="http://github.com/ppoffice" target="_blank">Ruipeng Zhang</a>'s <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank">Icarus theme</a> and <a href="https://www.flickr.com/photos/madison_slater/" target="_blank">Madison Slater</a>'s <a href="https://www.flickr.com/photos/madison_slater/11299339856/" target="_blank">photos</a>.</div></div></footer><script src="/js/jquery.js"></script><script src="/js/script.js"></script></div></body></html>