<!DOCTYPE html><html><head><meta charset="utf-8"><title>Creating an OpenID Connect server proxy with OpenIddict 3.0&#39;s degraded mode | Kévin Chalet&#39;s blog</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="description" content="In this post, discover how to create a minimalist OIDC server proxy between Steam and your own APIs."><meta property="og:type" content="article"><meta property="og:title" content="Creating an OpenID Connect server proxy with OpenIddict 3.0&#39;s degraded mode"><meta property="og:url" content="https://kevinchalet.com/2020/02/18/creating-an-openid-connect-server-proxy-with-openiddict-3-0-s-degraded-mode/index.html"><meta property="og:site_name" content="Kévin Chalet&#39;s blog"><meta property="og:description" content="In this post, discover how to create a minimalist OIDC server proxy between Steam and your own APIs."><meta property="og:locale" content="en_US"><meta property="og:image" content="https://kevinchalet.com/2020/02/18/creating-an-openid-connect-server-proxy-with-openiddict-3-0-s-degraded-mode/authorization-code-flow.png"><meta property="og:image" content="https://kevinchalet.com/2020/02/18/creating-an-openid-connect-server-proxy-with-openiddict-3-0-s-degraded-mode/steam.png"><meta property="og:image" content="https://kevinchalet.com/2020/02/18/creating-an-openid-connect-server-proxy-with-openiddict-3-0-s-degraded-mode/console.png"><meta property="article:published_time" content="2020-02-18T15:30:00.000Z"><meta property="article:modified_time" content="2020-06-11T20:34:12.000Z"><meta property="article:author" content="Kévin Chalet"><meta property="article:tag" content="asp.net core"><meta property="article:tag" content="aspnet-contrib"><meta property="article:tag" content="authentication"><meta property="article:tag" content="jwt"><meta property="article:tag" content="oauth"><meta property="article:tag" content="openid connect"><meta property="article:tag" content="openiddict"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://kevinchalet.com/2020/02/18/creating-an-openid-connect-server-proxy-with-openiddict-3-0-s-degraded-mode/authorization-code-flow.png"><meta name="twitter:creator" content="@kevin_chalet"><link rel="icon" href="https://kevinchalet.com/assets/photo.png"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css"><script type="text/javascript">!function(e,a,t,n,g,c,o){e.GoogleAnalyticsObject=g,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),o=a.getElementsByTagName(t)[0],c.async=1,c.src="//www.google-analytics.com/analytics.js",o.parentNode.insertBefore(c,o)}(window,document,"script",0,"ga"),ga("create","UA-79360312-1","auto"),ga("send","pageview")</script><meta name="generator" content="Hexo 6.2.0"></head><body><div id="container"><header id="header"><div id="header-main" class="header-inner"><div class="outer"><a href="/" id="logo"><span class="site-title">Kévin Chalet&#39;s blog</span></a><nav id="main-nav"><a class="main-nav-link" href="/.">Home</a> <a class="main-nav-link" href="/archives/">Archives</a></nav><nav id="sub-nav"><div class="profile" id="profile-nav"><a id="profile-anchor" href="javascript:;"><img class="avatar" src="https://kevinchalet.com/assets/photo.png"><i class="fa fa-caret-down"></i></a></div></nav><div id="search-form-wrap"><form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit"></button><input type="hidden" name="sitesearch" value="https://kevinchalet.com"></form></div></div></div></header><div class="outer"><aside id="profile"><div class="inner profile-inner"><div class="base-info profile-block"><img id="avatar" src="https://kevinchalet.com/assets/photo.png"><h2 id="name">Kévin Chalet</h2><h3 id="title">.NET-holic and OpenID-addict MVP in the wild.</h3><span id="location"><i class="fa fa-map-marker"></i>France</span> <a id="follow" target="_blank" rel="noopener" href="https://twitter.com/intent/user?screen_name=kevin_chalet"><i class="fa fa-twitter fa-lg"></i> Follow me on Twitter</a></div><div class="article-info profile-block"><div class="article-info-block">39 <span>posts</span></div><div class="article-info-block">29 <span>tags</span></div></div><div class="contact-info profile-block"><table class="contact-list"><tr><td><a href="mailto:contact@kevinchalet.com" title="Email"><i class="fa fa-envelope"></i></a></td><td><a target="_blank" rel="noopener" href="https://www.linkedin.com/in/kevinchalet/" title="LinkedIn"><i class="fa fa-linkedin"></i></a></td><td><a target="_blank" rel="noopener" href="https://github.com/kevinchalet" title="GitHub"><i class="fa fa-github"></i></a></td><td><a target="_blank" rel="noopener" href="https://twitter.com/kevin_chalet" title="Twitter"><i class="fa fa-twitter"></i></a></td><td><a target="_blank" rel="noopener" href="https://stackoverflow.com/users/542757/k%c3%a9vin-chalet" title="StackOverflow"><i class="fa fa-stack-overflow"></i></a></td><td><a target="_blank" rel="noopener" href="https://mvp.microsoft.com/fr-fr/PublicProfile/5001682" title="Microsoft MVP"><i class="fa fa-windows"></i></a></td><td><a href="/atom.xml" title="RSS"><i class="fa fa-rss"></i></a></td></tr></table></div></div></aside><section id="main"><article id="post-creating-an-openid-connect-server-proxy-with-openiddict-3-0-s-degraded-mode" class="article article-type-post" itemscope itemprop="blogPost"><div class="article-inner"><header class="article-header"><h1 class="article-title" itemprop="name">Creating an OpenID Connect server proxy with OpenIddict 3.0&#39;s degraded mode</h1><div class="article-meta"><div class="article-date"><i class="fa fa-calendar"></i> <a href="/2020/02/18/creating-an-openid-connect-server-proxy-with-openiddict-3-0-s-degraded-mode/"><time datetime="2020-02-18T15:30:00.000Z" itemprop="datePublished">2020-02-18</time></a></div></div></header><div class="article-entry" itemprop="articleBody"><p>As some of you may already know, <a href="https://github.com/openiddict/openiddict-core/issues/736" target="_blank" rel="external">I&#39;ve been working on OpenIddict 3.0 for a few months now</a>. <strong>One of the main goals of this major release is to merge <a href="https://github.com/aspnet-contrib/AspNet.Security.OpenIdConnect.Server" target="_blank" rel="external">ASOS</a></strong> (a low-level OpenID Connect server middleware for ASP.NET Core) <strong>and OpenIddict</strong> (a higher-level OIDC server library designed for less advanced users) into a unified code base, that would ideally represent the best of both worlds.</p><p><strong>As part of this task, a new feature was added to OpenIddict: the degraded mode</strong> (also known as the <em>ASOS-like</em> or <em>bare</em> mode). Put simply, <strong>this mode allows using OpenIddict&#39;s server without any backing database</strong>. Once enabled, all the features that rely on the OpenIddict application, authorization, scope and token managers (contained in the <code>OpenIddict.Core</code> package) are automatically disabled, which includes things like <code>client_id</code>/<code>client_secret</code> or <code>redirect_uri</code> validation, reference tokens and token revocation support. In other words, this mode allows switching from an &quot;all you can eat&quot; offer to a &quot;pay-to-play&quot; approach.</p><p>A thread, posted on <a href="https://github.com/aspnet-contrib/AspNet.Security.OpenId.Providers/issues/50" target="_blank" rel="external">one of the aspnet-contrib repositories</a> gave me a perfect opportunity to showcase this particular feature. The question asked by the commenters was simple: how can I use an external authentication provider like Steam (that implements the legacy OpenID 2.0 protocol) with my own API endpoints?</p><p><strong>Steam doesn&#39;t issue any access token you could directly use with your API endpoints</strong>. Actually, access tokens are not even a thing in OpenID 2.0, which is a pure authentication protocol that doesn&#39;t offer any authorization capability (unlike OAuth 1.0/2.0 or OpenID Connect).</p><p>So, how do we solve this problem? <strong>The most common approach typically consists in creating your own authorization server</strong> between your frontend application and the remote authentication provider (here, Steam). This way, when the application needs to authenticate a user, the user is redirected to the authorization server, that delegates the actual authentication part to another party. Once authenticated by that party, the user is redirected back to the main authorization server, that issues an access token to the client application.</p><img src="/2020/02/18/creating-an-openid-connect-server-proxy-with-openiddict-3-0-s-degraded-mode/authorization-code-flow.png" alt="authorization-code-flow.png"><p>This a super common scenario, that can be implemented using standard protocols like OpenID Connect and well-known implementations like OpenIddict or IdentityServer. However, <a href="https://github.com/aspnet-contrib/AspNet.Security.OpenId.Providers/issues/50#issuecomment-586734467" target="_blank" rel="external">these options are sometimes considered &quot;overkill&quot; for such simple scenarios</a>. After all, why would you need a fully-fledged OIDC server – with login, registration or consent views – when all you want is to delegate the actual authentication to another server in a totally transparent and almost invisible way?</p><p>Rolling your own protocol is tempting... <a href="https://github.com/aspnet-contrib/AspNet.Security.OpenId.Providers/issues/50#issuecomment-586726240" target="_blank" rel="external">but a very bad idea</a>, as you can&#39;t benefit from all the security measures offered by standard flows like OAuth 2.0/OpenID Connect&#39;s authorization code flow, whose threat model is clearly identified for many years now. <strong>As you may have guessed by now, this is precisely where OpenIddict 3.0&#39;s degraded mode can come in handy</strong>.</p><a id="more"></a><h2 id="Implementing-a-minimalist-OpenID-Connect-server-with-OpenIddict-3-0"><a href="#Implementing-a-minimalist-OpenID-Connect-server-with-OpenIddict-3-0" class="headerlink" title="Implementing a minimalist OpenID Connect server with OpenIddict 3.0"></a>Implementing a minimalist OpenID Connect server with OpenIddict 3.0</h2><h3 id="Add-the-Steam-authentication-integration"><a href="#Add-the-Steam-authentication-integration" class="headerlink" title="Add the Steam authentication integration"></a>Add the Steam authentication integration</h3><p>First, we&#39;ll start by creating an ASP.NET Core 3.1 API application and by adding the aspnet-contrib Steam provider and an instance of the cookies authentication handler (that will be used to store the user identity retrieved from Steam).</p><p>For that, add the following dependency in your .csproj:</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">Project</span> <span class="attr">Sdk</span>=<span class="string">"Microsoft.NET.Sdk.Web"</span>&gt;</span></div><div class="line"></div><div class="line">  <span class="tag">&lt;<span class="name">PropertyGroup</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">TargetFramework</span>&gt;</span>netcoreapp3.1<span class="tag">&lt;/<span class="name">TargetFramework</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">PropertyGroup</span>&gt;</span></div><div class="line"></div><div class="line">  <span class="tag">&lt;<span class="name">ItemGroup</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">PackageReference</span> <span class="attr">Include</span>=<span class="string">"AspNet.Security.OpenId.Steam"</span> <span class="attr">Version</span>=<span class="string">"3.0.0"</span> /&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">ItemGroup</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">Project</span>&gt;</span></div></pre></td></tr></table></figure><p>Then, update <code>ConfigureServices</code> to register the Steam and cookies authentication handlers:</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ConfigureServices</span>(<span class="params">IServiceCollection services</span>)</span></div><div class="line">&#123;</div><div class="line">    services.AddControllers();</div><div class="line"></div><div class="line">    services.AddAuthentication()</div><div class="line">        .AddCookie()</div><div class="line">        .AddSteam(options =&gt;</div><div class="line">        &#123;</div><div class="line">            options.SignInScheme = CookieAuthenticationDefaults.AuthenticationScheme;</div><div class="line"></div><div class="line">            <span class="comment">// To get additional claims from Steam's authentication APIs,</span></div><div class="line">            <span class="comment">// register your application and set the application key.</span></div><div class="line">            <span class="comment">//</span></div><div class="line">            <span class="comment">// options.ApplicationKey = "application_key";</span></div><div class="line">        &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>You&#39;ll also need to update <code>Configure</code> to call <code>app.UseAuthentication()</code>:</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Configure</span>(<span class="params">IApplicationBuilder app, IWebHostEnvironment env</span>)</span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span> (env.IsDevelopment())</div><div class="line">    &#123;</div><div class="line">        app.UseDeveloperExceptionPage();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    app.UseHttpsRedirection();</div><div class="line"></div><div class="line">    app.UseRouting();</div><div class="line"></div><div class="line">    app.UseAuthentication();</div><div class="line"></div><div class="line">    app.UseAuthorization();</div><div class="line"></div><div class="line">    app.UseEndpoints(endpoints =&gt;</div><div class="line">    &#123;</div><div class="line">        endpoints.MapControllers();</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="Add-the-OpenIddict-server-and-JWT-validation-components"><a href="#Add-the-OpenIddict-server-and-JWT-validation-components" class="headerlink" title="Add the OpenIddict server and JWT validation components"></a>Add the OpenIddict server and JWT validation components</h3><p>Now, we&#39;ll need to add the OpenID Connect server part. For that, add the following packages:</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">PackageReference</span> <span class="attr">Include</span>=<span class="string">"OpenIddict.Server.AspNetCore"</span> <span class="attr">Version</span>=<span class="string">"3.0.0-beta1.20311.67"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">PackageReference</span> <span class="attr">Include</span>=<span class="string">"OpenIddict.Validation.AspNetCore"</span> <span class="attr">Version</span>=<span class="string">"3.0.0-beta1.20311.67"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">PackageReference</span> <span class="attr">Include</span>=<span class="string">"OpenIddict.Validation.ServerIntegration"</span> <span class="attr">Version</span>=<span class="string">"3.0.0-beta1.20311.67"</span> /&gt;</span></div></pre></td></tr></table></figure><p>Next, tweak <code>ConfigureServices</code> to register the OpenIddict ASP.NET Core server and validation services, with only the options we need: the authorization code flow allowed, the authorization and token endpoints active and the degraded mode enabled:</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">services.AddOpenIddict()</div><div class="line">    .AddServer(options =&gt;</div><div class="line">    &#123;</div><div class="line">        options.AddDevelopmentEncryptionCertificate()</div><div class="line">               .AddDevelopmentSigningCertificate();</div><div class="line"></div><div class="line">        options.AllowAuthorizationCodeFlow();</div><div class="line"></div><div class="line">        options.SetAuthorizationEndpointUris(<span class="string">"/connect/authorize"</span>)</div><div class="line">               .SetTokenEndpointUris(<span class="string">"/connect/token"</span>);</div><div class="line"></div><div class="line">        options.EnableDegradedMode();</div><div class="line"></div><div class="line">        options.UseAspNetCore();</div><div class="line">    &#125;)</div><div class="line"></div><div class="line">    .AddValidation(options =&gt;</div><div class="line">    &#123;</div><div class="line">        options.UseLocalServer();</div><div class="line">        options.UseAspNetCore();</div><div class="line">    &#125;);</div></pre></td></tr></table></figure><p>At this point, trying to launch the application will result in an exception being thrown:</p><blockquote><p>InvalidOperationException: No custom authorization request validation handler was found. When enabling the degraded mode, a custom <code>IOpenIddictServerHandler&lt;ValidateAuthorizationRequestContext&gt;</code> must be implemented to validate authorization requests (e.g to ensure the client_id and redirect_uri are valid).</p></blockquote><p>This is expected: when using the degraded mode, you must add custom code to validate things that are normally validated for you by OpenIddict, which includes the <code>client_id</code> or <code>redirect_uri</code>, that must be checked to ensure users are not redirected to unsafe/unknown addresses.</p><p>To fix that error, we&#39;ll need to register a handler for the <code>ValidateAuthorizationRequest</code> event. Since we enabled the token endpoint, we&#39;ll also need one to validate token requests.</p><p>There are multiple ways to create and register event handlers in OpenIddict: you can create a dedicated class implementing the generic <code>IOpenIddictServerHandler&lt;TContext&gt;</code> interface – which allows using dependency injection – or you can use inline event handlers.</p><p>To keep things simple, we&#39;ll use inline event handlers (directly defined in <code>ConfigureServices</code>) and static hard-coded checks:</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line">services.AddOpenIddict()</div><div class="line">    .AddServer(options =&gt;</div><div class="line">    &#123;</div><div class="line">        <span class="comment">// ...</span></div><div class="line"></div><div class="line">        options.AddEventHandler&lt;ValidateAuthorizationRequestContext&gt;(builder =&gt;</div><div class="line">            builder.UseInlineHandler(context =&gt;</div><div class="line">            &#123;</div><div class="line">                <span class="keyword">if</span> (!<span class="keyword">string</span>.Equals(context.ClientId, <span class="string">"console_app"</span>, StringComparison.Ordinal))</div><div class="line">                &#123;</div><div class="line">                    context.Reject(</div><div class="line">                        error: Errors.InvalidClient,</div><div class="line">                        description: <span class="string">"The specified 'client_id' doesn't match a registered application."</span>);</div><div class="line"></div><div class="line">                    <span class="keyword">return</span> <span class="keyword">default</span>;</div><div class="line">                &#125;</div><div class="line"></div><div class="line">                <span class="keyword">if</span> (!<span class="keyword">string</span>.Equals(context.RedirectUri, <span class="string">"http://localhost:7890/"</span>, StringComparison.Ordinal))</div><div class="line">                &#123;</div><div class="line">                    context.Reject(</div><div class="line">                        error: Errors.InvalidClient,</div><div class="line">                        description: <span class="string">"The specified 'redirect_uri' is not valid for this client application."</span>);</div><div class="line"></div><div class="line">                    <span class="keyword">return</span> <span class="keyword">default</span>;</div><div class="line">                &#125;</div><div class="line"></div><div class="line">                <span class="keyword">return</span> <span class="keyword">default</span>;</div><div class="line">            &#125;));</div><div class="line"></div><div class="line">        options.AddEventHandler&lt;ValidateTokenRequestContext&gt;(builder =&gt;</div><div class="line">            builder.UseInlineHandler(context =&gt;</div><div class="line">            &#123;</div><div class="line">                <span class="keyword">if</span> (!<span class="keyword">string</span>.Equals(context.ClientId, <span class="string">"console_app"</span>, StringComparison.Ordinal))</div><div class="line">                &#123;</div><div class="line">                    context.Reject(</div><div class="line">                        error: Errors.InvalidClient,</div><div class="line">                        description: <span class="string">"The specified 'client_id' doesn't match a registered application."</span>);</div><div class="line"></div><div class="line">                    <span class="keyword">return</span> <span class="keyword">default</span>;</div><div class="line">                &#125;</div><div class="line"></div><div class="line">                <span class="comment">// This demo is used by a single public client application.</span></div><div class="line">                <span class="comment">// As such, no client secret validation is performed.</span></div><div class="line"></div><div class="line">                <span class="keyword">return</span> <span class="keyword">default</span>;</div><div class="line">            &#125;));</div><div class="line">    &#125;);</div></pre></td></tr></table></figure><p><strong>Final and most interesting part: gluing everything together</strong>, so that OpenIddict can redirect users to Steam and generate an authorization response containing an authorization code that the client application will be able to use to redeem an access token. To implement that, we need to use the <code>HandleAuthorizationRequest</code> event:</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">options.AddEventHandler&lt;HandleAuthorizationRequestContext&gt;(builder =&gt;</div><div class="line">    builder.UseInlineHandler(<span class="keyword">async</span> context =&gt;</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">var</span> request = context.Transaction.GetHttpRequest() ??</div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> InvalidOperationException(<span class="string">"The ASP.NET Core request cannot be retrieved."</span>);</div><div class="line"></div><div class="line">        <span class="comment">// Retrieve the security principal created by the Steam handler and stored in the authentication cookie.</span></div><div class="line">        <span class="comment">// If the principal cannot be retrieved, this indicates that the user is not logged in. In this case,</span></div><div class="line">        <span class="comment">// an authentication challenge is triggered to redirect the user to Steam's authentication endpoint.</span></div><div class="line">        <span class="keyword">var</span> principal = (<span class="keyword">await</span> request.HttpContext.AuthenticateAsync(SteamAuthenticationDefaults.AuthenticationScheme))?.Principal;</div><div class="line">        <span class="keyword">if</span> (principal == <span class="literal">null</span>)</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">await</span> request.HttpContext.ChallengeAsync(SteamAuthenticationDefaults.AuthenticationScheme);</div><div class="line">            context.HandleRequest();</div><div class="line"></div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">var</span> identity = <span class="keyword">new</span> ClaimsIdentity(TokenValidationParameters.DefaultAuthenticationType);</div><div class="line"></div><div class="line">        <span class="comment">// Use the "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier" claim</span></div><div class="line">        <span class="comment">// (added by the Steam handler to store the user identifier) as the OIDC "sub" claim.</span></div><div class="line">        identity.AddClaim(<span class="keyword">new</span> Claim(Claims.Subject, principal.GetClaim(ClaimTypes.NameIdentifier)));</div><div class="line"></div><div class="line">        <span class="comment">// If needed, you can copy more claims from the cookies principal to the bearer principal.</span></div><div class="line">        <span class="comment">// To get more claims from the Steam handler, you'll need to set the application key.</span></div><div class="line"></div><div class="line">        <span class="comment">// Mark all the added claims as being allowed to be persisted in the access token,</span></div><div class="line">        <span class="comment">// so that the API controllers can retrieve them from the ClaimsPrincipal instance.</span></div><div class="line">        <span class="keyword">foreach</span> (<span class="keyword">var</span> claim <span class="keyword">in</span> identity.Claims)</div><div class="line">        &#123;</div><div class="line">            claim.SetDestinations(Destinations.AccessToken);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">// Attach the principal to the authorization context, so that an OpenID Connect response</span></div><div class="line">        <span class="comment">// with an authorization code can be generated by the OpenIddict server services.</span></div><div class="line">        context.Principal = <span class="keyword">new</span> ClaimsPrincipal(identity);</div><div class="line">    &#125;));</div></pre></td></tr></table></figure><div class="note tip"><p>Adding a handler for <code>HandleTokenRequestContext</code> is not necessary: in this case, OpenIddict will automatically reuse the user identity extracted from the authorization code to produce an access token returned as part of the token response.</p></div><h2 id="Creating-a-NET-demo-console"><a href="#Creating-a-NET-demo-console" class="headerlink" title="Creating a .NET demo console"></a>Creating a .NET demo console</h2><p>To test our minimalist OpenID Connect proxy, we&#39;ll now create a separate .NET Core 3.1 console referencing the <code>IdentityModel.OidcClient</code> package:</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">Project</span> <span class="attr">Sdk</span>=<span class="string">"Microsoft.NET.Sdk"</span>&gt;</span></div><div class="line"></div><div class="line">  <span class="tag">&lt;<span class="name">PropertyGroup</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">OutputType</span>&gt;</span>Exe<span class="tag">&lt;/<span class="name">OutputType</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">TargetFramework</span>&gt;</span>netcoreapp3.1<span class="tag">&lt;/<span class="name">TargetFramework</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">LangVersion</span>&gt;</span>8.0<span class="tag">&lt;/<span class="name">LangVersion</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">PropertyGroup</span>&gt;</span></div><div class="line"></div><div class="line">  <span class="tag">&lt;<span class="name">ItemGroup</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">PackageReference</span> <span class="attr">Include</span>=<span class="string">"IdentityModel.OidcClient"</span> <span class="attr">Version</span>=<span class="string">"4.0.0-preview.1.3"</span> /&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">ItemGroup</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">Project</span>&gt;</span></div></pre></td></tr></table></figure><p>There are typically <strong>2 ways to handle authorization responses in desktop/mobile applications</strong> (i.e applications that don&#39;t run inside a browser):</p><ul><li><p><strong>Running a local HTTP server</strong>: this works well for desktop applications, but might be hard to implement in certain enterprise environments with strict firewall configurations.</p></li><li><p><strong>Registering an application-specific URI scheme</strong> (e.g: <code>myapp://</code>): this is the best approach... and pretty much the only option on most mobile operating systems, where the first option is not always possible, for security reasons.</p></li></ul><p>Since the first option is easier to implement, it&#39;s the one we will choose for this demo client:</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">using</span> System;</div><div class="line"><span class="keyword">using</span> System.Diagnostics;</div><div class="line"><span class="keyword">using</span> System.Net;</div><div class="line"><span class="keyword">using</span> System.Threading.Tasks;</div><div class="line"><span class="keyword">using</span> IdentityModel.OidcClient;</div><div class="line"><span class="keyword">using</span> <span class="keyword">static</span> IdentityModel.OidcConstants;</div><div class="line"></div><div class="line"><span class="keyword">namespace</span> <span class="title">OpenIddictClientDemo</span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">Program</span></div><div class="line">    &#123;</div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">async</span> Task <span class="title">Main</span>(<span class="params"><span class="keyword">string</span>[] args</span>)</span></div><div class="line">        &#123;</div><div class="line">            Console.WriteLine(<span class="string">"Press any key to start the authentication process."</span>);</div><div class="line">            Console.ReadKey();</div><div class="line"></div><div class="line">            <span class="comment">// Create a local web server used to receive the authorization response.</span></div><div class="line">            <span class="keyword">using</span> <span class="keyword">var</span> listener = <span class="keyword">new</span> HttpListener();</div><div class="line">            listener.Prefixes.Add(<span class="string">"http://localhost:7890/"</span>);</div><div class="line">            listener.Start();</div><div class="line"></div><div class="line">            <span class="keyword">var</span> options = <span class="keyword">new</span> OidcClientOptions</div><div class="line">            &#123;</div><div class="line">                Authority = <span class="string">"https://localhost:44322/"</span>,</div><div class="line">                ClientId = <span class="string">"console_app"</span>,</div><div class="line">                LoadProfile = <span class="literal">false</span>,</div><div class="line">                RedirectUri = <span class="string">"http://localhost:7890/"</span>,</div><div class="line">                Scope = StandardScopes.OpenId</div><div class="line">            &#125;;</div><div class="line"></div><div class="line">            <span class="keyword">var</span> client = <span class="keyword">new</span> OidcClient(options);</div><div class="line">            <span class="keyword">var</span> state = <span class="keyword">await</span> client.PrepareLoginAsync();</div><div class="line"></div><div class="line">            <span class="comment">// Launch the system browser to initiate the authentication dance.</span></div><div class="line">            Process.Start(<span class="keyword">new</span> ProcessStartInfo</div><div class="line">            &#123;</div><div class="line">                FileName = state.StartUrl,</div><div class="line">                UseShellExecute = <span class="literal">true</span></div><div class="line">            &#125;);</div><div class="line"></div><div class="line">            <span class="comment">// Wait for an authorization response to be posted to the local server.</span></div><div class="line">            <span class="keyword">while</span> (<span class="literal">true</span>)</div><div class="line">            &#123;</div><div class="line">                <span class="keyword">var</span> context = <span class="keyword">await</span> listener.GetContextAsync();</div><div class="line">                context.Response.StatusCode = <span class="number">204</span>;</div><div class="line">                context.Response.Close();</div><div class="line"></div><div class="line">                <span class="keyword">var</span> result = <span class="keyword">await</span> client.ProcessResponseAsync(context.Request.Url.Query, state);</div><div class="line">                <span class="keyword">if</span> (result.IsError)</div><div class="line">                &#123;</div><div class="line">                    Console.WriteLine(<span class="string">"An error occurred: &#123;0&#125;"</span>, result.Error);</div><div class="line">                &#125;</div><div class="line"></div><div class="line">                <span class="keyword">else</span></div><div class="line">                &#123;</div><div class="line">                    Console.WriteLine(<span class="string">"\n\nClaims:"</span>);</div><div class="line"></div><div class="line">                    <span class="keyword">foreach</span> (<span class="keyword">var</span> claim <span class="keyword">in</span> result.User.Claims)</div><div class="line">                    &#123;</div><div class="line">                        Console.WriteLine(<span class="string">"&#123;0&#125;: &#123;1&#125;"</span>, claim.Type, claim.Value);</div><div class="line">                    &#125;</div><div class="line"></div><div class="line">                    Console.WriteLine();</div><div class="line">                    Console.WriteLine(<span class="string">"Access token:\n&#123;0&#125;"</span>, result.AccessToken);</div><div class="line"></div><div class="line">                    <span class="keyword">break</span>;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            Console.ReadLine();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="Testing-the-authentication-process"><a href="#Testing-the-authentication-process" class="headerlink" title="Testing the authentication process"></a>Testing the authentication process</h2><p>For that, start the two applications (server and client). Once the client is started, press a key to start the authentication process. When doing so, the default browser will be launched and you&#39;ll be redirected to the authorization server. If you&#39;re not already logged in, you&#39;ll be immediately invited to authenticate using your Steam account:</p><img src="/2020/02/18/creating-an-openid-connect-server-proxy-with-openiddict-3-0-s-degraded-mode/steam.png" alt="steam.png"><p>After logging in, an authorization response will be returned to the client console, that will automatically send a token request to finish the process:</p><img src="/2020/02/18/creating-an-openid-connect-server-proxy-with-openiddict-3-0-s-degraded-mode/console.png" alt="console.png"><p>And voilà, you&#39;re now ready to create your first APIs! To accept the JWT bearer tokens issued by OpenIddict, don&#39;t forget to decorate your controllers/actions with:</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[Authorize(AuthenticationSchemes = OpenIddictValidationAspNetCoreDefaults.AuthenticationScheme)]</div></pre></td></tr></table></figure></div><footer class="article-footer"><a data-url="https://kevinchalet.com/2020/02/18/creating-an-openid-connect-server-proxy-with-openiddict-3-0-s-degraded-mode/" data-id="cl02sbe26008xkki12ozjhqxb" class="article-share-link">Share</a><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/asp-net-core/" rel="tag">asp.net core</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/aspnet-contrib/" rel="tag">aspnet-contrib</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/authentication/" rel="tag">authentication</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/jwt/" rel="tag">jwt</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/oauth/" rel="tag">oauth</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/openid-connect/" rel="tag">openid connect</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/openiddict/" rel="tag">openiddict</a></li></ul></footer></div><nav id="article-nav"><a href="/2020/03/03/adding-openiddict-3-0-to-an-owin-application/" id="article-nav-newer" class="article-nav-link-wrap"><strong class="article-nav-caption">Newer</strong><div class="article-nav-title">Adding OpenIddict 3.0 to an OWIN application</div></a><a href="/2019/04/11/forcing-an-old-net-application-to-support-tls-1-2-without-recompiling-it/" id="article-nav-older" class="article-nav-link-wrap"><strong class="article-nav-caption">Older</strong><div class="article-nav-title">Forcing an old .NET application to support TLS 1.2 without recompiling it</div></a></nav></article></section><aside id="sidebar"><div class="widget-wrap"><h3 class="widget-title">recents</h3><div class="widget"><ul id="recent-post" class="no-thumbnail"><li><div class="item-inner"><p class="item-title"><a href="/2022/06/22/openiddict-4-0-preview1-is-out/" class="title">OpenIddict 4.0 preview1 is out</a></p><p class="item-date"><time datetime="2022-06-22T18:00:00.000Z" itemprop="datePublished">2022-06-22</time></p></div></li><li><div class="item-inner"><p class="item-title"><a href="/2022/02/25/introducing-the-openiddict-client/" class="title">Introducing the OpenIddict client</a></p><p class="item-date"><time datetime="2022-02-25T21:00:00.000Z" itemprop="datePublished">2022-02-25</time></p></div></li><li><div class="item-inner"><p class="item-title"><a href="/2021/05/24/asp-net-core-6-and-authentication-servers-the-real-bait-and-switch-is-not-the-one-you-think/" class="title">ASP.NET Core 6 and authentication servers: the real bait and switch is not the one you think</a></p><p class="item-date"><time datetime="2021-05-24T18:30:00.000Z" itemprop="datePublished">2021-05-24</time></p></div></li><li><div class="item-inner"><p class="item-title"><a href="/2020/12/23/openiddict-3-0-general-availability/" class="title">OpenIddict 3.0 general availability</a></p><p class="item-date"><time datetime="2020-12-23T21:00:00.000Z" itemprop="datePublished">2020-12-23</time></p></div></li><li><div class="item-inner"><p class="item-title"><a href="/2020/11/17/introducing-openiddict-3-0-s-first-release-candidate-version/" class="title">Introducing OpenIddict 3.0&#39;s first release candidate version</a></p><p class="item-date"><time datetime="2020-11-17T21:00:00.000Z" itemprop="datePublished">2020-11-17</time></p></div></li></ul></div></div><div class="widget-wrap"><h3 class="widget-title">categories</h3><div class="widget"><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/development/">Development</a><span class="category-list-count">28</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/general/">General</a><span class="category-list-count">1</span></li></ul></div></div><div class="widget-wrap"><h3 class="widget-title">tags</h3><div class="widget"><ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/net/" rel="tag">.net</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/asp-net/" rel="tag">asp.net</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/asp-net-core/" rel="tag">asp.net core</a><span class="tag-list-count">27</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/asp-net-core-identity/" rel="tag">asp.net core identity</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/aspnet-contrib/" rel="tag">aspnet-contrib</a><span class="tag-list-count">23</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/auth0/" rel="tag">auth0</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/authentication/" rel="tag">authentication</a><span class="tag-list-count">33</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/azure/" rel="tag">azure</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/azure-ad/" rel="tag">azure ad</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cms/" rel="tag">cms</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/component-object-model/" rel="tag">component object model</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jwt/" rel="tag">jwt</a><span class="tag-list-count">31</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/manifest/" rel="tag">manifest</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/oauth/" rel="tag">oauth</a><span class="tag-list-count">33</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/okta/" rel="tag">okta</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/openid/" rel="tag">openid</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/openid-connect/" rel="tag">openid connect</a><span class="tag-list-count">32</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/openiddict/" rel="tag">openiddict</a><span class="tag-list-count">18</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/orchard/" rel="tag">orchard</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/orchardcore/" rel="tag">orchardcore</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/owin/" rel="tag">owin</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/razor/" rel="tag">razor</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tls/" rel="tag">tls</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/uwp/" rel="tag">uwp</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vulnerability/" rel="tag">vulnerability</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web-authentication-broker/" rel="tag">web authentication broker</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/windows/" rel="tag">windows</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/windows-10/" rel="tag">windows 10</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/windows-media-center/" rel="tag">windows media center</a><span class="tag-list-count">1</span></li></ul></div></div><div class="widget-wrap"><h3 class="widget-title">archives</h3><div class="widget"><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">June 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">February 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">May 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">December 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">November 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">June 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">February 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">January 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">November 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">August 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">July 2016</a><span class="archive-list-count">9</span></li></ul></div></div></aside></div><footer id="footer"><div class="outer"><div id="footer-info" class="inner">&copy; 2016 - 2022 Kévin Chalet<br>Proudly powered by <a href="http://hexo.io/" target="_blank">Hexo</a> with <a href="http://github.com/ppoffice" target="_blank">Ruipeng Zhang</a>'s <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank">Icarus theme</a> and <a href="https://www.flickr.com/photos/madison_slater/" target="_blank">Madison Slater</a>'s <a href="https://www.flickr.com/photos/madison_slater/11299339856/" target="_blank">photos</a>.</div></div></footer><script src="/js/jquery.js"></script><script src="/js/script.js"></script></div></body></html>